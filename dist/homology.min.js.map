{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap","webpack:///./node_modules/@babel/runtime/regenerator/index.js","webpack:///./node_modules/regenerator-runtime/runtime.js","webpack:///./src/error.js","webpack:///./src/oma.js","webpack:///./src/organism-map.js","webpack:///./src/lib.js","webpack:///./src/orthodb.js","webpack:///./src/homology.js","webpack:///./src/index.js"],"names":["root","factory","exports","module","define","amd","a","i","window","installedModules","__webpack_require__","moduleId","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","runtime","Op","hasOwn","$Symbol","iteratorSymbol","iterator","asyncIteratorSymbol","asyncIterator","toStringTagSymbol","obj","configurable","writable","err","wrap","innerFn","outerFn","self","tryLocsList","protoGenerator","Generator","generator","context","Context","_invoke","state","method","arg","Error","doneResult","delegate","delegateResult","maybeInvokeDelegate","ContinueSentinel","sent","_sent","dispatchException","abrupt","record","tryCatch","type","done","makeInvokeMethod","fn","GeneratorFunction","GeneratorFunctionPrototype","IteratorPrototype","this","getProto","getPrototypeOf","NativeIteratorPrototype","values","Gp","defineIteratorMethods","forEach","AsyncIterator","PromiseImpl","previousPromise","callInvokeWithMethodAndArg","resolve","reject","invoke","result","__await","then","unwrapped","error","undefined","TypeError","info","resultName","next","nextLoc","pushTryEntry","locs","entry","tryLoc","catchLoc","finallyLoc","afterLoc","tryEntries","push","resetTryEntry","completion","reset","iterable","iteratorMethod","isNaN","length","constructor","displayName","isGeneratorFunction","genFun","ctor","mark","setPrototypeOf","__proto__","awrap","async","Promise","iter","toString","keys","reverse","pop","skipTempReset","prev","charAt","slice","stop","rootRecord","rval","exception","handle","loc","caught","hasCatch","hasFinally","finallyEntry","complete","finish","thrown","delegateYield","regeneratorRuntime","accidentalStrictMode","Function","normalizeOrganismName","genusSpecies","split","toUpperCase","join","reportError","summaries","summary","detail","errorObj","gene","org1","org2","message","omaBase","fetchUniprotId","org","uniprotBase","columns","query","fetch","response","text","data","lines","genes","map","toLowerCase","uniprotId","includes","fetchOmaOrthologs","omaUrl","json","status","fetchOmaProtein","getOmaIdPrefix","genus","species","sourceOrg","targetOrgs","orthologs","proteinId","sourceProtein","rawOrthologs","targetOrgPrefixes","theseOrthologs","filter","rawOrtholog","omaId","omaid","omaIdPrefix","unshift","canonicalid","location","chromosome","locus","start","end","fetchOrthologsFromOma","taxidsByName","ret","fetchAnnotsFromEUtils","ncbiGeneIds","annots","ncbiBase","uids","uid","genomicinfo","annot","id","chr","chrloc","chrstart","chrstop","fetchMyGeneInfo","queryString","parseAnnotFromMgiGene","genomicPos","Array","isArray","genomic_pos","pos","symbol","ensemblgene","getMyGeneInfoQueryString","taxid","qParam","ensemblId","escapedGene","replace","fetchLocations","insufficientData","hits","ncbiGeneId","orthodbBase","fetchOrthoDBJson","path","isRest","getNcbiGeneId","ogDetails","entrez","xrefs","xref","getOrthoDBId","url","splitId","isNumeric","parseFloat","isFinite","getOrthologMap","sparqlJson","orthologMap","seenTargetNames","sources","results","bindings","rawSource","gene_s_name","source","rawSources","find","sourceId","gene_s","gene_t_name","splitName","nonNumericName","sort","b","gene_t","sortTargetGenes","targetGenes","sourceGene","geneA","geneB","exons","domains","aDomains","bDomains","sourceDomains","aDiff","Math","abs","bDiff","enrichGene","ensembl","aas","interpro","enrichMap","forceEnrich","enrichedMap","enrichedSources","all","entries","sourceName","targets","every","target","enrichedSource","promises","enrichedTargets","isSuitableMatch","candidate","referenceName","fetchOrthologsFromOrthodbSparql","genesClause","targetOrg","sourceTaxid","targetTaxid","encodeURIComponent","sourceLocations","rawTargets","concat","targetLocations","ortholog","sourceLocation","sl","targetGene","targetName","targetLocation","tl","api","fetchOrthologs"],"mappings":"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","file":"homology.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse {\n\t\tvar a = factory();\n\t\tfor(var i in a) (typeof exports === 'object' ? exports : root)[i] = a[i];\n\t}\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/dist\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 2);\n","module.exports = require(\"regenerator-runtime\");\n","/**\n * Copyright (c) 2014-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nvar runtime = (function (exports) {\n  \"use strict\";\n\n  var Op = Object.prototype;\n  var hasOwn = Op.hasOwnProperty;\n  var undefined; // More compressible than void 0.\n  var $Symbol = typeof Symbol === \"function\" ? Symbol : {};\n  var iteratorSymbol = $Symbol.iterator || \"@@iterator\";\n  var asyncIteratorSymbol = $Symbol.asyncIterator || \"@@asyncIterator\";\n  var toStringTagSymbol = $Symbol.toStringTag || \"@@toStringTag\";\n\n  function define(obj, key, value) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n    return obj[key];\n  }\n  try {\n    // IE 8 has a broken Object.defineProperty that only works on DOM objects.\n    define({}, \"\");\n  } catch (err) {\n    define = function(obj, key, value) {\n      return obj[key] = value;\n    };\n  }\n\n  function wrap(innerFn, outerFn, self, tryLocsList) {\n    // If outerFn provided and outerFn.prototype is a Generator, then outerFn.prototype instanceof Generator.\n    var protoGenerator = outerFn && outerFn.prototype instanceof Generator ? outerFn : Generator;\n    var generator = Object.create(protoGenerator.prototype);\n    var context = new Context(tryLocsList || []);\n\n    // The ._invoke method unifies the implementations of the .next,\n    // .throw, and .return methods.\n    generator._invoke = makeInvokeMethod(innerFn, self, context);\n\n    return generator;\n  }\n  exports.wrap = wrap;\n\n  // Try/catch helper to minimize deoptimizations. Returns a completion\n  // record like context.tryEntries[i].completion. This interface could\n  // have been (and was previously) designed to take a closure to be\n  // invoked without arguments, but in all the cases we care about we\n  // already have an existing method we want to call, so there's no need\n  // to create a new function object. We can even get away with assuming\n  // the method takes exactly one argument, since that happens to be true\n  // in every case, so we don't have to touch the arguments object. The\n  // only additional allocation required is the completion record, which\n  // has a stable shape and so hopefully should be cheap to allocate.\n  function tryCatch(fn, obj, arg) {\n    try {\n      return { type: \"normal\", arg: fn.call(obj, arg) };\n    } catch (err) {\n      return { type: \"throw\", arg: err };\n    }\n  }\n\n  var GenStateSuspendedStart = \"suspendedStart\";\n  var GenStateSuspendedYield = \"suspendedYield\";\n  var GenStateExecuting = \"executing\";\n  var GenStateCompleted = \"completed\";\n\n  // Returning this object from the innerFn has the same effect as\n  // breaking out of the dispatch switch statement.\n  var ContinueSentinel = {};\n\n  // Dummy constructor functions that we use as the .constructor and\n  // .constructor.prototype properties for functions that return Generator\n  // objects. For full spec compliance, you may wish to configure your\n  // minifier not to mangle the names of these two functions.\n  function Generator() {}\n  function GeneratorFunction() {}\n  function GeneratorFunctionPrototype() {}\n\n  // This is a polyfill for %IteratorPrototype% for environments that\n  // don't natively support it.\n  var IteratorPrototype = {};\n  IteratorPrototype[iteratorSymbol] = function () {\n    return this;\n  };\n\n  var getProto = Object.getPrototypeOf;\n  var NativeIteratorPrototype = getProto && getProto(getProto(values([])));\n  if (NativeIteratorPrototype &&\n      NativeIteratorPrototype !== Op &&\n      hasOwn.call(NativeIteratorPrototype, iteratorSymbol)) {\n    // This environment has a native %IteratorPrototype%; use it instead\n    // of the polyfill.\n    IteratorPrototype = NativeIteratorPrototype;\n  }\n\n  var Gp = GeneratorFunctionPrototype.prototype =\n    Generator.prototype = Object.create(IteratorPrototype);\n  GeneratorFunction.prototype = Gp.constructor = GeneratorFunctionPrototype;\n  GeneratorFunctionPrototype.constructor = GeneratorFunction;\n  GeneratorFunction.displayName = define(\n    GeneratorFunctionPrototype,\n    toStringTagSymbol,\n    \"GeneratorFunction\"\n  );\n\n  // Helper for defining the .next, .throw, and .return methods of the\n  // Iterator interface in terms of a single ._invoke method.\n  function defineIteratorMethods(prototype) {\n    [\"next\", \"throw\", \"return\"].forEach(function(method) {\n      define(prototype, method, function(arg) {\n        return this._invoke(method, arg);\n      });\n    });\n  }\n\n  exports.isGeneratorFunction = function(genFun) {\n    var ctor = typeof genFun === \"function\" && genFun.constructor;\n    return ctor\n      ? ctor === GeneratorFunction ||\n        // For the native GeneratorFunction constructor, the best we can\n        // do is to check its .name property.\n        (ctor.displayName || ctor.name) === \"GeneratorFunction\"\n      : false;\n  };\n\n  exports.mark = function(genFun) {\n    if (Object.setPrototypeOf) {\n      Object.setPrototypeOf(genFun, GeneratorFunctionPrototype);\n    } else {\n      genFun.__proto__ = GeneratorFunctionPrototype;\n      define(genFun, toStringTagSymbol, \"GeneratorFunction\");\n    }\n    genFun.prototype = Object.create(Gp);\n    return genFun;\n  };\n\n  // Within the body of any async function, `await x` is transformed to\n  // `yield regeneratorRuntime.awrap(x)`, so that the runtime can test\n  // `hasOwn.call(value, \"__await\")` to determine if the yielded value is\n  // meant to be awaited.\n  exports.awrap = function(arg) {\n    return { __await: arg };\n  };\n\n  function AsyncIterator(generator, PromiseImpl) {\n    function invoke(method, arg, resolve, reject) {\n      var record = tryCatch(generator[method], generator, arg);\n      if (record.type === \"throw\") {\n        reject(record.arg);\n      } else {\n        var result = record.arg;\n        var value = result.value;\n        if (value &&\n            typeof value === \"object\" &&\n            hasOwn.call(value, \"__await\")) {\n          return PromiseImpl.resolve(value.__await).then(function(value) {\n            invoke(\"next\", value, resolve, reject);\n          }, function(err) {\n            invoke(\"throw\", err, resolve, reject);\n          });\n        }\n\n        return PromiseImpl.resolve(value).then(function(unwrapped) {\n          // When a yielded Promise is resolved, its final value becomes\n          // the .value of the Promise<{value,done}> result for the\n          // current iteration.\n          result.value = unwrapped;\n          resolve(result);\n        }, function(error) {\n          // If a rejected Promise was yielded, throw the rejection back\n          // into the async generator function so it can be handled there.\n          return invoke(\"throw\", error, resolve, reject);\n        });\n      }\n    }\n\n    var previousPromise;\n\n    function enqueue(method, arg) {\n      function callInvokeWithMethodAndArg() {\n        return new PromiseImpl(function(resolve, reject) {\n          invoke(method, arg, resolve, reject);\n        });\n      }\n\n      return previousPromise =\n        // If enqueue has been called before, then we want to wait until\n        // all previous Promises have been resolved before calling invoke,\n        // so that results are always delivered in the correct order. If\n        // enqueue has not been called before, then it is important to\n        // call invoke immediately, without waiting on a callback to fire,\n        // so that the async generator function has the opportunity to do\n        // any necessary setup in a predictable way. This predictability\n        // is why the Promise constructor synchronously invokes its\n        // executor callback, and why async functions synchronously\n        // execute code before the first await. Since we implement simple\n        // async functions in terms of async generators, it is especially\n        // important to get this right, even though it requires care.\n        previousPromise ? previousPromise.then(\n          callInvokeWithMethodAndArg,\n          // Avoid propagating failures to Promises returned by later\n          // invocations of the iterator.\n          callInvokeWithMethodAndArg\n        ) : callInvokeWithMethodAndArg();\n    }\n\n    // Define the unified helper method that is used to implement .next,\n    // .throw, and .return (see defineIteratorMethods).\n    this._invoke = enqueue;\n  }\n\n  defineIteratorMethods(AsyncIterator.prototype);\n  AsyncIterator.prototype[asyncIteratorSymbol] = function () {\n    return this;\n  };\n  exports.AsyncIterator = AsyncIterator;\n\n  // Note that simple async functions are implemented on top of\n  // AsyncIterator objects; they just return a Promise for the value of\n  // the final result produced by the iterator.\n  exports.async = function(innerFn, outerFn, self, tryLocsList, PromiseImpl) {\n    if (PromiseImpl === void 0) PromiseImpl = Promise;\n\n    var iter = new AsyncIterator(\n      wrap(innerFn, outerFn, self, tryLocsList),\n      PromiseImpl\n    );\n\n    return exports.isGeneratorFunction(outerFn)\n      ? iter // If outerFn is a generator, return the full iterator.\n      : iter.next().then(function(result) {\n          return result.done ? result.value : iter.next();\n        });\n  };\n\n  function makeInvokeMethod(innerFn, self, context) {\n    var state = GenStateSuspendedStart;\n\n    return function invoke(method, arg) {\n      if (state === GenStateExecuting) {\n        throw new Error(\"Generator is already running\");\n      }\n\n      if (state === GenStateCompleted) {\n        if (method === \"throw\") {\n          throw arg;\n        }\n\n        // Be forgiving, per 25.3.3.3.3 of the spec:\n        // https://people.mozilla.org/~jorendorff/es6-draft.html#sec-generatorresume\n        return doneResult();\n      }\n\n      context.method = method;\n      context.arg = arg;\n\n      while (true) {\n        var delegate = context.delegate;\n        if (delegate) {\n          var delegateResult = maybeInvokeDelegate(delegate, context);\n          if (delegateResult) {\n            if (delegateResult === ContinueSentinel) continue;\n            return delegateResult;\n          }\n        }\n\n        if (context.method === \"next\") {\n          // Setting context._sent for legacy support of Babel's\n          // function.sent implementation.\n          context.sent = context._sent = context.arg;\n\n        } else if (context.method === \"throw\") {\n          if (state === GenStateSuspendedStart) {\n            state = GenStateCompleted;\n            throw context.arg;\n          }\n\n          context.dispatchException(context.arg);\n\n        } else if (context.method === \"return\") {\n          context.abrupt(\"return\", context.arg);\n        }\n\n        state = GenStateExecuting;\n\n        var record = tryCatch(innerFn, self, context);\n        if (record.type === \"normal\") {\n          // If an exception is thrown from innerFn, we leave state ===\n          // GenStateExecuting and loop back for another invocation.\n          state = context.done\n            ? GenStateCompleted\n            : GenStateSuspendedYield;\n\n          if (record.arg === ContinueSentinel) {\n            continue;\n          }\n\n          return {\n            value: record.arg,\n            done: context.done\n          };\n\n        } else if (record.type === \"throw\") {\n          state = GenStateCompleted;\n          // Dispatch the exception by looping back around to the\n          // context.dispatchException(context.arg) call above.\n          context.method = \"throw\";\n          context.arg = record.arg;\n        }\n      }\n    };\n  }\n\n  // Call delegate.iterator[context.method](context.arg) and handle the\n  // result, either by returning a { value, done } result from the\n  // delegate iterator, or by modifying context.method and context.arg,\n  // setting context.delegate to null, and returning the ContinueSentinel.\n  function maybeInvokeDelegate(delegate, context) {\n    var method = delegate.iterator[context.method];\n    if (method === undefined) {\n      // A .throw or .return when the delegate iterator has no .throw\n      // method always terminates the yield* loop.\n      context.delegate = null;\n\n      if (context.method === \"throw\") {\n        // Note: [\"return\"] must be used for ES3 parsing compatibility.\n        if (delegate.iterator[\"return\"]) {\n          // If the delegate iterator has a return method, give it a\n          // chance to clean up.\n          context.method = \"return\";\n          context.arg = undefined;\n          maybeInvokeDelegate(delegate, context);\n\n          if (context.method === \"throw\") {\n            // If maybeInvokeDelegate(context) changed context.method from\n            // \"return\" to \"throw\", let that override the TypeError below.\n            return ContinueSentinel;\n          }\n        }\n\n        context.method = \"throw\";\n        context.arg = new TypeError(\n          \"The iterator does not provide a 'throw' method\");\n      }\n\n      return ContinueSentinel;\n    }\n\n    var record = tryCatch(method, delegate.iterator, context.arg);\n\n    if (record.type === \"throw\") {\n      context.method = \"throw\";\n      context.arg = record.arg;\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    var info = record.arg;\n\n    if (! info) {\n      context.method = \"throw\";\n      context.arg = new TypeError(\"iterator result is not an object\");\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    if (info.done) {\n      // Assign the result of the finished delegate to the temporary\n      // variable specified by delegate.resultName (see delegateYield).\n      context[delegate.resultName] = info.value;\n\n      // Resume execution at the desired location (see delegateYield).\n      context.next = delegate.nextLoc;\n\n      // If context.method was \"throw\" but the delegate handled the\n      // exception, let the outer generator proceed normally. If\n      // context.method was \"next\", forget context.arg since it has been\n      // \"consumed\" by the delegate iterator. If context.method was\n      // \"return\", allow the original .return call to continue in the\n      // outer generator.\n      if (context.method !== \"return\") {\n        context.method = \"next\";\n        context.arg = undefined;\n      }\n\n    } else {\n      // Re-yield the result returned by the delegate method.\n      return info;\n    }\n\n    // The delegate iterator is finished, so forget it and continue with\n    // the outer generator.\n    context.delegate = null;\n    return ContinueSentinel;\n  }\n\n  // Define Generator.prototype.{next,throw,return} in terms of the\n  // unified ._invoke helper method.\n  defineIteratorMethods(Gp);\n\n  define(Gp, toStringTagSymbol, \"Generator\");\n\n  // A Generator should always return itself as the iterator object when the\n  // @@iterator function is called on it. Some browsers' implementations of the\n  // iterator prototype chain incorrectly implement this, causing the Generator\n  // object to not be returned from this call. This ensures that doesn't happen.\n  // See https://github.com/facebook/regenerator/issues/274 for more details.\n  Gp[iteratorSymbol] = function() {\n    return this;\n  };\n\n  Gp.toString = function() {\n    return \"[object Generator]\";\n  };\n\n  function pushTryEntry(locs) {\n    var entry = { tryLoc: locs[0] };\n\n    if (1 in locs) {\n      entry.catchLoc = locs[1];\n    }\n\n    if (2 in locs) {\n      entry.finallyLoc = locs[2];\n      entry.afterLoc = locs[3];\n    }\n\n    this.tryEntries.push(entry);\n  }\n\n  function resetTryEntry(entry) {\n    var record = entry.completion || {};\n    record.type = \"normal\";\n    delete record.arg;\n    entry.completion = record;\n  }\n\n  function Context(tryLocsList) {\n    // The root entry object (effectively a try statement without a catch\n    // or a finally block) gives us a place to store values thrown from\n    // locations where there is no enclosing try statement.\n    this.tryEntries = [{ tryLoc: \"root\" }];\n    tryLocsList.forEach(pushTryEntry, this);\n    this.reset(true);\n  }\n\n  exports.keys = function(object) {\n    var keys = [];\n    for (var key in object) {\n      keys.push(key);\n    }\n    keys.reverse();\n\n    // Rather than returning an object with a next method, we keep\n    // things simple and return the next function itself.\n    return function next() {\n      while (keys.length) {\n        var key = keys.pop();\n        if (key in object) {\n          next.value = key;\n          next.done = false;\n          return next;\n        }\n      }\n\n      // To avoid creating an additional object, we just hang the .value\n      // and .done properties off the next function object itself. This\n      // also ensures that the minifier will not anonymize the function.\n      next.done = true;\n      return next;\n    };\n  };\n\n  function values(iterable) {\n    if (iterable) {\n      var iteratorMethod = iterable[iteratorSymbol];\n      if (iteratorMethod) {\n        return iteratorMethod.call(iterable);\n      }\n\n      if (typeof iterable.next === \"function\") {\n        return iterable;\n      }\n\n      if (!isNaN(iterable.length)) {\n        var i = -1, next = function next() {\n          while (++i < iterable.length) {\n            if (hasOwn.call(iterable, i)) {\n              next.value = iterable[i];\n              next.done = false;\n              return next;\n            }\n          }\n\n          next.value = undefined;\n          next.done = true;\n\n          return next;\n        };\n\n        return next.next = next;\n      }\n    }\n\n    // Return an iterator with no values.\n    return { next: doneResult };\n  }\n  exports.values = values;\n\n  function doneResult() {\n    return { value: undefined, done: true };\n  }\n\n  Context.prototype = {\n    constructor: Context,\n\n    reset: function(skipTempReset) {\n      this.prev = 0;\n      this.next = 0;\n      // Resetting context._sent for legacy support of Babel's\n      // function.sent implementation.\n      this.sent = this._sent = undefined;\n      this.done = false;\n      this.delegate = null;\n\n      this.method = \"next\";\n      this.arg = undefined;\n\n      this.tryEntries.forEach(resetTryEntry);\n\n      if (!skipTempReset) {\n        for (var name in this) {\n          // Not sure about the optimal order of these conditions:\n          if (name.charAt(0) === \"t\" &&\n              hasOwn.call(this, name) &&\n              !isNaN(+name.slice(1))) {\n            this[name] = undefined;\n          }\n        }\n      }\n    },\n\n    stop: function() {\n      this.done = true;\n\n      var rootEntry = this.tryEntries[0];\n      var rootRecord = rootEntry.completion;\n      if (rootRecord.type === \"throw\") {\n        throw rootRecord.arg;\n      }\n\n      return this.rval;\n    },\n\n    dispatchException: function(exception) {\n      if (this.done) {\n        throw exception;\n      }\n\n      var context = this;\n      function handle(loc, caught) {\n        record.type = \"throw\";\n        record.arg = exception;\n        context.next = loc;\n\n        if (caught) {\n          // If the dispatched exception was caught by a catch block,\n          // then let that catch block handle the exception normally.\n          context.method = \"next\";\n          context.arg = undefined;\n        }\n\n        return !! caught;\n      }\n\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        var record = entry.completion;\n\n        if (entry.tryLoc === \"root\") {\n          // Exception thrown outside of any try block that could handle\n          // it, so set the completion value of the entire function to\n          // throw the exception.\n          return handle(\"end\");\n        }\n\n        if (entry.tryLoc <= this.prev) {\n          var hasCatch = hasOwn.call(entry, \"catchLoc\");\n          var hasFinally = hasOwn.call(entry, \"finallyLoc\");\n\n          if (hasCatch && hasFinally) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            } else if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else if (hasCatch) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            }\n\n          } else if (hasFinally) {\n            if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else {\n            throw new Error(\"try statement without catch or finally\");\n          }\n        }\n      }\n    },\n\n    abrupt: function(type, arg) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc <= this.prev &&\n            hasOwn.call(entry, \"finallyLoc\") &&\n            this.prev < entry.finallyLoc) {\n          var finallyEntry = entry;\n          break;\n        }\n      }\n\n      if (finallyEntry &&\n          (type === \"break\" ||\n           type === \"continue\") &&\n          finallyEntry.tryLoc <= arg &&\n          arg <= finallyEntry.finallyLoc) {\n        // Ignore the finally entry if control is not jumping to a\n        // location outside the try/catch block.\n        finallyEntry = null;\n      }\n\n      var record = finallyEntry ? finallyEntry.completion : {};\n      record.type = type;\n      record.arg = arg;\n\n      if (finallyEntry) {\n        this.method = \"next\";\n        this.next = finallyEntry.finallyLoc;\n        return ContinueSentinel;\n      }\n\n      return this.complete(record);\n    },\n\n    complete: function(record, afterLoc) {\n      if (record.type === \"throw\") {\n        throw record.arg;\n      }\n\n      if (record.type === \"break\" ||\n          record.type === \"continue\") {\n        this.next = record.arg;\n      } else if (record.type === \"return\") {\n        this.rval = this.arg = record.arg;\n        this.method = \"return\";\n        this.next = \"end\";\n      } else if (record.type === \"normal\" && afterLoc) {\n        this.next = afterLoc;\n      }\n\n      return ContinueSentinel;\n    },\n\n    finish: function(finallyLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.finallyLoc === finallyLoc) {\n          this.complete(entry.completion, entry.afterLoc);\n          resetTryEntry(entry);\n          return ContinueSentinel;\n        }\n      }\n    },\n\n    \"catch\": function(tryLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc === tryLoc) {\n          var record = entry.completion;\n          if (record.type === \"throw\") {\n            var thrown = record.arg;\n            resetTryEntry(entry);\n          }\n          return thrown;\n        }\n      }\n\n      // The context.catch method must only be called with a location\n      // argument that corresponds to a known catch block.\n      throw new Error(\"illegal catch attempt\");\n    },\n\n    delegateYield: function(iterable, resultName, nextLoc) {\n      this.delegate = {\n        iterator: values(iterable),\n        resultName: resultName,\n        nextLoc: nextLoc\n      };\n\n      if (this.method === \"next\") {\n        // Deliberately forget the last sent value so that we don't\n        // accidentally pass it on to the delegate.\n        this.arg = undefined;\n      }\n\n      return ContinueSentinel;\n    }\n  };\n\n  // Regardless of whether this script is executing as a CommonJS module\n  // or not, return the runtime object so that we can declare the variable\n  // regeneratorRuntime in the outer scope, which allows this module to be\n  // injected easily by `bin/regenerator --include-runtime script.js`.\n  return exports;\n\n}(\n  // If this script is executing as a CommonJS module, use module.exports\n  // as the regeneratorRuntime namespace. Otherwise create a new empty\n  // object. Either way, the resulting object will be used to initialize\n  // the regeneratorRuntime variable at the top of this file.\n  typeof module === \"object\" ? module.exports : {}\n));\n\ntry {\n  regeneratorRuntime = runtime;\n} catch (accidentalStrictMode) {\n  // This module should not be running in strict mode, so the above\n  // assignment should always work unless something is misconfigured. Just\n  // in case runtime.js accidentally runs in strict mode, we can escape\n  // strict mode using a global Function call. This could conceivably fail\n  // if a Content Security Policy forbids using Function, but in that case\n  // the proper solution is to fix the accidental strict mode problem. If\n  // you've misconfigured your bundler to force strict mode and applied a\n  // CSP to forbid Function, and you're not willing to fix either of those\n  // problems, please detail your unique predicament in a GitHub issue.\n  Function(\"r\", \"regeneratorRuntime = r\")(runtime);\n}\n","/**\n * Converts an all-lowercase name to uppercase genus, lowercase species\n * Example: mus musculus -> Mus musculus\n */\nfunction normalizeOrganismName(name) {\n  var genusSpecies, genus, species;\n  genusSpecies = name.split(' ');\n\n  // e.g. mus -> Mus\n  genus = genusSpecies[0][0].toUpperCase() + genusSpecies[0].slice(1,);\n\n  // Account for subspecies name, e.g. Canis lupus familiaris\n  species = genusSpecies.slice(1,).join(' ');\n\n  return genus + ' ' + species;\n}\n\nfunction reportError(error, errorObj=null, gene=null, org1=null, org2=null) {\n  var summaries, summary, detail;\n\n  if (org1 !== null) org1 = normalizeOrganismName(org1);\n  if (org2 !== null) org2 = normalizeOrganismName(org2[0]);\n\n  summaries = {\n      'geneNotFound': `Gene \"${gene}\" not found in source organism \"${org1}\"`,\n      'orthologsNotFound': `Orthologs not found for gene \"${gene}\"`,\n      'orthologsNotFoundInTarget':\n        `Orthologs not found for gene \"${gene}\" in target organism \"${org2}\"`\n  }\n  detail = errorObj ? `<br/><small>${errorObj.message}</small>` : '';\n  summary = summaries[error] + detail\n  throw new Error(summary);\n}\n\nexport {reportError}","/**\n * @fileoverview Client library for OMA (Orthology MAtrix)\n * API docs: https://omabrowser.org/api/docs\n *\n * This module supports fetching orthologs from OMA.  All functions here\n * support the single exported function `fetchOrthologsFromOma`.\n */\n\nimport {reportError} from './error';\n\nvar omaBase = 'https://omabrowser.org/api';\n\n/**\n  * Query Uniprot API for protein entry ID (e.g. P53_RAT) given gene and\n  * organism.  This output is needed as input for the OMA API.\n  */\nasync function fetchUniprotId(gene, org) {\n  var uniprotBase, columns, query, query, response, data, lines, columns,\n    i, genes, uniprotId;\n\n  // Selected headers:\n  //   - Entry, Entry name, Gene names\n  // Default headers (omit `columns` parameter):\n  //   - Entry, Entry name, Status, Protein names, Gene names, Organism, Length\n  columns = 'columns=id,entry name,genes';\n\n  // API docs: https://www.uniprot.org/help/api_queries\n  uniprotBase = (\n    'https://www.uniprot.org/uniprot/?format=tab&' + columns +\n    '&sort=score'\n  );\n\n  query = '&query=gene:' + gene + '+AND+organism:' + org;\n  response = await fetch(uniprotBase + query);\n  data = await response.text();\n  lines = data.split('\\n').slice(1, -1); // Omit headers, empty last line\n\n  for (i = 0; i < lines.length; i++) {\n    columns = lines[i].split('\\t');\n    genes = columns[2].split(' ').map(d => d.toLowerCase()); // e.g. tp53\n    uniprotId = columns[0]; // e.g. P53_RAT\n    // uniprotName = columns[1]; // e.g. P53_RAT\n\n    if (genes.includes(gene.toLowerCase())) return uniprotId;\n  }\n\n  throw Error(\n    'No Uniprot entry found for gene name \"' + gene + '\" ' +\n    'in organism \"' + org + '\"'\n  );\n}\n\n/**\n  * Query OMA API for orthology information on a protein \n  */\nasync function fetchOmaOrthologs(uniprotId) {\n  var omaUrl, response, data;\n  omaUrl = omaBase + '/protein/' + uniprotId + '/orthologs/';\n  response = await fetch(omaUrl);\n  data = await response.json();\n  if (response.status === 404) {\n    throw Error(\n      'OMA orthologs not found for Uniprot protein \"' + uniprotId + '\".'\n    );\n  }\n  return data;\n}\n\n/**\n  * Query OMA API for information on a protein\n  */\nasync function fetchOmaProtein(uniprotId) {\n  var omaUrl, response, data;\n  omaUrl = omaBase + '/protein/' + uniprotId + '/';\n  response = await fetch(omaUrl);\n  data = await response.json();\n  if (response.status === 404) {\n    throw Error(\n      'OMA protein not found for Uniprot protein \"' + uniprotId + '\".'\n    );\n  }\n  return data;\n}\n\n/**\n  * Convert organism scientific name to OMA ID prefix.\n  * Example: \"rattus-norvegicus -> \"RATNO\"\n  */\nfunction getOmaIdPrefix(org) {\n  // If this function proves inadequate, then refactor to use\n  // https://omabrowser.org/api/taxonomy/.  Fetch on page load, collapse\n  // tree, return leaf nodes as object with `name` as keys and `code` as\n  // values.\n  //\n  // As is, the implementation below seems adequate, simpler, and faster.\n  var prefix, genus, species;\n  if (org === 'homo sapiens') {\n    return 'HUMAN';\n  } else if (org === 'mus musculus') {\n    return 'MOUSE';\n  } else {\n    [genus, species] = org.split(' ');\n    prefix = genus.slice(0, 3) + species.slice(0, 2);\n    prefix = prefix.toUpperCase();\n    return prefix;\n  }\n}\n\n/**\n  * Given genes in a source organism, retrieve their orthologs in\n  * other organisms.  Returns OMA protein records for source and target\n  * organisms.\n  */\nasync function fetchOrthologsFromOma(genes, sourceOrg, targetOrgs) {\n  var proteinId, sourceProtein, rawOrthologs, omaId, omaIdPrefix,\n    theseOrthologs, error, targetOrgPrefixes, i, gene,\n    orthologs = [];\n\n  for (i = 0; i < genes.length; i++) {\n    gene = genes[i];\n    try {\n      proteinId = await fetchUniprotId(gene, sourceOrg);\n      sourceProtein = await fetchOmaProtein(proteinId);\n    } catch(error) {\n      reportError('geneNotFound', error, gene, sourceOrg, targetOrgs);\n    }\n    try {\n      rawOrthologs = await fetchOmaOrthologs(proteinId);\n    } catch(error) {\n      reportError('orthologsNotFound', error, gene, sourceOrg, targetOrgs);\n    }\n\n    // Get OMA ID prefixes for each target organism\n    targetOrgPrefixes = targetOrgs.map(org => getOmaIdPrefix(org));\n\n    theseOrthologs = rawOrthologs.filter(rawOrtholog => {\n      omaId = rawOrtholog.omaid; // e.g. RATNO03710\n      omaIdPrefix = omaId.slice(0, 5); // e.g. RATNO\n      return targetOrgPrefixes.includes(omaIdPrefix);\n    });\n\n    if (theseOrthologs.length === 0) {\n      reportError('orthologsNotFoundInTarget', error, gene, sourceOrg, targetOrgs);\n    }\n\n    theseOrthologs.unshift(sourceProtein); // prepend to array\n\n    theseOrthologs = theseOrthologs.map(d => {\n      return {\n        gene: d.canonicalid,\n        location: d.chromosome + ':' + d.locus.start + '-' + d.locus.end\n      }\n    });\n    orthologs.push(theseOrthologs);\n  }\n\n  return orthologs;\n}\n\nexport default fetchOrthologsFromOma;","export const taxidsByName = {\n  'aedes aegypti': '7159',\n  'anopheles gambiae': '7165',\n  'arabidopsis thaliana': '3702',\n  'aspergillis fumigatus': '746128',\n  'aspergillus niger': '5061',\n  'aspergillus oryzae': '5062',\n  'bos taurus': '9913',\n  'brachypodium distachyon': '15368',\n  'caenorhabditis elegans': '6239',\n  'callithrix jacchus': '9483',\n  'canis lupus familiaris': '9615',\n  'chlorocebus sabaeus': '60711',\n  'ciona intestinalis': '7719',\n  'capsicum annuum': '4072',\n  'culex quinquefasciatus': '7176',\n  'danio rerio': '7955',\n  'drosophila melanogaster': '7227',\n  'equus caballus': '9796',\n  'felis catus': '9685',\n  'gallus gallus': '9031',\n  'glycine max': '3847',\n  'gorilla gorilla': '9593',\n  'homo sapiens': '9606',\n  'hordeum vulgare': '4513',\n  'macaca fascicularis': '9541',\n  'macaca mulatta': '9544',\n  'mus musculus': '10090',\n  'musa acuminata': '4641',\n  'oryza sativa': '4530',\n  'ornithorhynchus anatinus': '9258',\n  'pan paniscus': '9597',\n  'pan troglodytes': '9598',\n  'plasmodium falciparum': '5833',\n  'rattus norvegicus': '10116',\n  'saccharomyces cerevisiae': '4932',\n  'solanum lycopersicum': '4081',\n  'sus scrofa': '9823',\n  'vitis vinifera': '29760',\n  'zea mays': '4577'\n}\n\n// Invert keys and values in object, per\n// https://stackoverflow.com/a/23013726/10564415\nfunction invert(obj) {\n  const ret = {};\n  Object.keys(obj).forEach(key => {\n    ret[obj[key]] = key;\n  });\n  return ret;\n}\n\nexport const namesByTaxid = invert(taxidsByName)\n\n","/**\n * Get genomic coordinates of a gene using its NCBI Gene ID\n */\n export async function fetchAnnotsFromEUtils(ncbiGeneIds) {\n  const annots = []\n\n  const apiKey = '&api_key=e7ce8adecd69d0457df7ec2ccbb704c4e709';\n\n  const ncbiBase =\n    'https://eutils.ncbi.nlm.nih.gov/entrez/eutils/esummary.fcgi' +\n    '?db=gene&retmode=json' + apiKey;\n\n  // Example:\n  // https://eutils.ncbi.nlm.nih.gov/entrez/eutils/esummary.fcgi?db=gene&retmode=json&id=3565955\n  const response = await fetch(ncbiBase + '&id=' + ncbiGeneIds.join(','))\n  const data = await response.json()\n  const result = data.result\n\n  result.uids.forEach(uid => {\n    const gene = result[uid]\n    const loc = gene.genomicinfo[0]\n\n    const annot = {\n      name: gene.name,\n      id: gene.uid\n    }\n\n    if (loc) {\n      annot.chr = loc.chrloc,\n      annot.start = loc.chrstart,\n      annot.stop = loc.chrstop,\n      annot.location = annot.chr + ':' + annot.start + '-' + annot.stop\n    }\n\n    annots.push(annot)\n  })\n\n  return annots\n}\n\n/**\n * Queries MyGene.info API, returns parsed JSON\n *\n * Docs:\n * https://docs.mygene.info/en/v3/\n *\n * Example:\n * https://mygene.info/v3/query?q=symbol:cdk2%20OR%20symbol:brca1&species=9606&fields=symbol,genomic_pos,name\n */\n async function fetchMyGeneInfo(queryString) {\n  const myGeneBase = 'https://mygene.info/v3/query';\n  const response = await fetch(myGeneBase + queryString + '&size=20');\n  const data = await response.json();\n  return data;\n}\n\n/**\n * Transforms MyGene.info (MGI) gene into Ideogram annotation\n */\n function parseAnnotFromMgiGene(gene) {\n\n  // Filters out placements on alternative loci scaffolds, an advanced\n  // genome assembly feature we are not concerned with in ideograms.\n  //\n  // Example:\n  // https://mygene.info/v3/query?q=symbol:PTPRC&species=9606&fields=symbol,genomic_pos,name\n  let genomicPos = null;\n  if (Array.isArray(gene.genomic_pos)) {\n    genomicPos = gene.genomic_pos.filter(pos => !pos.chr.includes('_'))[0];\n  } else {\n    genomicPos = gene.genomic_pos;\n  }\n\n  const annot = {\n    name: gene.symbol,\n    chr: genomicPos.chr,\n    start: genomicPos.start,\n    stop: genomicPos.end,\n    id: genomicPos.ensemblgene\n  };\n\n  annot.location = annot.chr + ':' + annot.start + '-' + annot.stop\n\n  return annot;\n}\n\nfunction getMyGeneInfoQueryString(genes, taxid) {\n  const qParam = genes.map(gene => {\n    if (gene.ensemblId) {\n      return `ensemblgene:${gene.ensemblId}`\n    } else {\n    // Escape genes, so e.g. the fly gene Su(H) becomes Su\\(H\\).\n    // https://mygene.info/v3/query?q=symbol:Su\\(H\\)&species=7227&fields=symbol,genomic_pos,name&size=20\n    // See https://github.com/biothings/mygene.info/issues/112.\n    if (gene.name) gene = gene.name\n    const escapedGene = gene.replace(/\\(/g, '\\\\(').replace(/\\)/g, '\\\\)')\n    return `symbol:${escapedGene}`;\n    }\n  }).join(' OR ');\n\n  // Example:\n  // https://mygene.info/v3/query?q=symbol:BRCA1&species=9606&fields=symbol,genomic_pos,name\n  return `?q=${qParam}&species=${taxid}&fields=symbol,genomic_pos,name,exons`;\n}\n\n/**\n * Fetch gene positions from MyGene.info (MGI), with NCBI as fallback\n *\n * MGI is fast but incomplete.  NCBI is slow but complete.  So try MGI\n * first, and fallback to the more robust but less speedy NCBI if MGI\n * results don't return adequate data.\n */\nexport async function fetchLocations(genes, taxid) {\n  let annots = [];\n\n  const queryString = getMyGeneInfoQueryString(genes, taxid)\n  const data = await fetchMyGeneInfo(queryString);\n\n  let insufficientData = false\n  if (data.hits.length < genes.length) insufficientData = true\n\n  data.hits.forEach(gene => {\n    // If hit lacks position or name/id, flag for fallback approach\n    if (\n      'genomic_pos' in gene === false ||\n      ('name' in gene === false && '_id' in gene === false)\n    ) {\n      insufficientData = true\n      return\n    };\n\n    const annot = parseAnnotFromMgiGene(gene);\n    annots.push(annot);\n  });\n\n  // If MGI fails, try getting data from NCBI\n  if (insufficientData) {\n    if (typeof genes[0] === 'string' || 'ncbiGeneId' in genes[0] === false) {\n      // Send a signal upstream that we need more data from OrthoDB\n      throw Error('Enrichment needed')\n    }\n    const ncbiGeneIds = genes.map(gene => gene.ncbiGeneId)\n    annots = await fetchAnnotsFromEUtils(ncbiGeneIds)\n  }\n\n  return annots;\n}\n","/**\n* @fileoverview Client library for OrthoDB\n* API docs: https://www.orthodb.org/?page=api\n*\n* This module supports fetching orthologs from OrthoDB, using:\n* - REST API, via fetchOrthologsFromOrthodb, or\n* - SPARQL API, via fetchOrthologsFromOrthodbSparql\n*\n* The SPARQL API is more robust and faster, but the REST API\n* is retained as a potential future fallback.\n*/\n\nimport {taxidsByName} from './organism-map';\nimport {reportError} from './error';\nimport {fetchLocations, fetchAnnotsFromEUtils} from './lib';\n\n// OrthoDB does not support CORS.  Homology API on Firebase proxies OrthoDB and\n// supports CORS.  This enables client-side web requests to the OrthoDB API.\n//\n// var orthodbBase = 'https://www.orthodb.org/';\nvar orthodbBase = 'https://homology-api.firebaseapp.com/orthodb/';\n// var orthodbBase = 'http://localhost:5000/orthodb/';\n// var orthodbBase = 'http://localhost:5001/homology-api/us-central1/app/orthodb/'\n\n/**\n * Get JSON response from OrthoDB API\n */\nexport async function fetchOrthoDBJson(path, isRest=true) {\n  var response = await fetch(orthodbBase + path);\n  var json = await response.json();\n  if (isRest) {\n    return json.data;\n  } else {\n    return json;\n  }\n}\n\n/** Get NCBI Gene ID from ogDetails object */\nfunction getNcbiGeneId(ogDetails) {\n  var ncbiGeneId;\n\n  if ('entrez' in ogDetails) {\n    ncbiGeneId = ogDetails.entrez[0].id;\n  } else {\n    // Occurs in Drosophila melanogaster, e.g.\n    // https://homology-api.firebaseapp.com/orthodb/ogdetails?id=7227_0:000534\n    ogDetails.xrefs.forEach(xref => {\n      if (xref.type === 'NCBIgene') ncbiGeneId = xref.name;\n    });\n  }\n\n  return ncbiGeneId\n}\n\n/**\n * E.g. http://purl.orthodb.org/odbgene/6239_0_000f12 -> 6239_0:000f12\n */\nfunction getOrthoDBId(url) {\n  const splitId = url.split('/').slice(-1)[0].split('_')\n  return splitId[0] + '_' + splitId[1] + ':' + splitId[2]\n}\n\n/** Determine if n is a number */\nfunction isNumeric(n) {\n  return !isNaN(parseFloat(n)) && isFinite(n);\n}\n\n/** Deduplicates gene names in a list of results from SPARQL query */\nfunction getOrthologMap(genes, sparqlJson) {\n\n  const orthologMap = {}\n  const seenTargetNames = {}\n  genes.forEach(gene => {\n    seenTargetNames[gene] = []\n    orthologMap[gene] = []\n  })\n\n  const sources = {}\n\n  sparqlJson.results.bindings.forEach(result => {\n    const rawSource = result.gene_s_name.value\n    let source = rawSource\n    if (rawSource.includes(';')) {\n      // Accounts for e.g. searching for ortholog of human \"ACE2\" in mouse\n      // OrthoDB returns the raw source \"ACE2;BMX\"\n      const rawSources = rawSource.split(';')\n      source = genes.find(gene => rawSources.includes(gene))\n\n      // No name match found, as in search for human RAD51 in Zea mays.\n      if (typeof source === 'undefined') return\n    }\n\n    const sourceId = getOrthoDBId(result.gene_s.value)\n\n    // If user e.g. types in \"mtor\" for human, canonicalize to \"MTOR\".\n    // This makes source gene matches case-insensitive, as expected.\n    genes.forEach(gene => {\n      if (\n        gene in orthologMap &&\n        gene !== source &&\n        gene.toLowerCase() === source.toLowerCase()\n      ) {\n        orthologMap[source] = orthologMap[gene].slice()\n        seenTargetNames[source] = seenTargetNames[gene].slice()\n        delete orthologMap[gene]\n        delete seenTargetNames[gene]\n      }\n    })\n\n    // if (orthologMap[source]?.length > 0) {\n      sources[source] = {id: sourceId}\n    // }\n\n    let name = result.gene_t_name.value;\n\n    // Handle OrthoDB's unique practice of sometimes including aliases\n    // via semicolon-delmiting the name.  This can break downstream\n    // look-up of genomic position, which first queries by name (and does\n    // not expect semicolons).\n    if (name.includes(';')) {\n      const splitName = name.split(';')\n      const numericName = splitName.find(name => isNumeric(name))\n\n      if (numericName) {\n        // Use the non-numeric name if one exists, or the first name\n        const nonNumericName = splitName.find(name => !isNumeric(name))\n        name = nonNumericName ? nonNumericName : splitName[0]\n      } else {\n        // Use the shorter name of the two, which is typically the more\n        // prominent one.\n        name = splitName.sort((a, b) => a.length < b.length)[0]\n      }\n    }\n\n    const id = getOrthoDBId(result.gene_t.value)\n    if (source in seenTargetNames && !seenTargetNames[source].includes(name)) {\n      seenTargetNames[source].push(name)\n      orthologMap[source].push({name, id})\n    }\n  })\n\n  return {orthologMap, sources}\n}\n\n/**\n * Sort orthologs by name similarity to source gene\n *\n * A given gene (source gene) can have multiple target genes (orthologs).\n *\n */\nfunction sortTargetGenes(targetGenes, sourceGene, sources) {\n  const source = sources[sourceGene]\n  sourceGene = sourceGene.toLowerCase()\n  return targetGenes.sort((a, b) => {\n    const geneA = a.name.toLowerCase()\n    const geneB = b.name.toLowerCase()\n\n    if (geneA === sourceGene) return -1\n    if (geneB === sourceGene) return 1\n\n    if (a.exons !== b.exons) {\n      if (a.exons == source.exons) return -1\n      if (b.exons == source.exons) return 1\n    }\n\n    if (\n      a.domains?.length > 1 && b.domains?.length > 1 &&\n      geneA !== sourceGene && geneB !== sourceGene\n    ) {\n      // Good test case: search for human THAP1 in mouse\n      const aDomains = a.domains.length\n      const bDomains = b.domains.length\n      const sourceDomains = source.domains.length\n\n      if (aDomains === sourceDomains) return -1\n      if (bDomains === sourceDomains) return 1\n\n      const aDiff = Math.abs(aDomains - sourceDomains)\n      const bDiff = Math.abs(bDomains - sourceDomains)\n      if (aDiff < bDiff) return -1\n      if (aDiff > bDiff) return 1\n    }\n  })\n}\n\n/**\n * Add Ensembl ID, domains, # amino acids, # exons to a gene.\n */\nasync function enrichGene(gene) {\n  const ogDetails = await fetchOrthoDBJson('ogdetails?id=' + gene.id);\n  // console.log('ogDetails for gene', ogDetails)\n  if (ogDetails.ensembl) {\n    gene.ensemblId = ogDetails.ensembl[0].id\n  }\n\n  gene.ncbiGeneId = getNcbiGeneId(ogDetails)\n\n  gene.aas = ogDetails.aas // length in amino acids\n  gene.exons = ogDetails.exons // number of exons\n  gene.domains = ogDetails.interpro\n\n  return gene\n}\n\n/**\n * Add Ensembl ID, domains, # amino acids, # exons to source and target genes.\n */\nasync function enrichMap(orthologMap, sources, forceEnrich = false) {\n\n  const enrichedMap = {}\n  const enrichedSources = {}\n\n  // Parallelizes as described in https://medium.com/@antonioval/6315c3225838\n  // (but without library advertised there).\n  await Promise.all(\n    Object.entries(orthologMap).map(async ([sourceName, targets]) => {\n      const sourceGene = sources[sourceName]\n\n      if (typeof sourceGene === 'undefined') {\n        throw Error(`${sourceName} not found in target`)\n      }\n\n      // If any target matches the source name, it's an ortholog\n      // and we can drastically speed up the UI by avoiding all the\n      // network chatter needs for enrichment\n      const needsEnrichment = forceEnrich || targets.every(target => {\n        return target.name.toLowerCase() !== sourceName.toLowerCase()\n      })\n\n      if (needsEnrichment === false) {\n        enrichedMap[sourceName] = targets\n        return\n      }\n\n      const enrichedSource = await enrichGene(sourceGene)\n\n      enrichedSources[sourceName] = enrichedSource\n\n      // Parallelize OrthoDB REST API requests\n      const promises = targets.map(async target => await enrichGene(target))\n      const enrichedTargets = await Promise.all(promises)\n\n      enrichedMap[sourceName] = enrichedTargets\n    })\n  )\n\n  orthologMap = enrichedMap\n  sources = enrichedSources\n\n  return {orthologMap, sources}\n}\n\n/** Compare two strings, roughly. */\nfunction fuzzyMatch(a, b) {\n  if (a === b) return true\n\n  // Disregard hyphens, e.g. allow searching Arabidopsis NFYC6,\n  // which formally has symbol \"NF-YC6\", to match human NFYC6\n  // (which formally has symbol \"NFYC6\").\n  const fuzzyA = a.replace(/-/g, '')\n  const fuzzyB = b.replace(/-/g, '')\n\n  return fuzzyA === fuzzyB\n}\n\n/** Determines whether a candidate object matches a reference */\nfunction isSuitableMatch(candidate, referenceName) {\n  return (\n    candidate.name !== undefined &&\n\n    // Encountered when searching e.g. SP5G and PG2\n    // between Solanum lycopersicum and Capsicum annuum.\n    candidate.location !== undefined &&\n\n    fuzzyMatch(candidate.name, referenceName)\n  )\n}\n\nasync function fetchOrthologsFromOrthodbSparql(genes, sourceOrg, targetOrgs) {\n  const genesClause = genes.join('%7C') // URL encoding for | (i.e. OR)\n\n  // TODO: Support multiple target organisms\n  const targetOrg = targetOrgs[0]\n\n  const sourceTaxid = taxidsByName[sourceOrg]\n  const targetTaxid = taxidsByName[targetOrg]\n\n  const query = encodeURIComponent([\n    'prefix : <http://purl.orthodb.org/>',\n    'select *',\n    'where {',\n      '?og a :OrthoGroup .',\n      '?gene_s a :Gene .', // source gene\n      '?gene_t a :Gene .', // target gene\n      `?gene_s up:organism/a taxon:${sourceTaxid} .`,\n      `?gene_t up:organism/a taxon:${targetTaxid} .`,\n      '?gene_s :memberOf ?og .',\n      '?gene_t :memberOf ?og .',\n      '?gene_s :name ?gene_s_name .',\n      '?gene_t :name ?gene_t_name .',\n      `filter (regex(?gene_s_name, \"(^;?${genesClause};?)\", \"i\"))`,\n    '}'\n  ].join('\\n'));\n\n  // Below is an example query for ACE2, which you can plug\n  // into https://sparql.orthodb.org to debug or explore.\n  //\n  // The \";?\" clauses handle edge cases, where e.g. the queried gene \"ACE2\"\n  // matches against the \"ACE2;BMX\" source gene contained in OrthoDB.\n  //\n  // prefix : <http://purl.orthodb.org/>\n  // select *\n  // where {\n  // ?og a :OrthoGroup .\n  // ?gene_s a :Gene .\n  // ?gene_t a :Gene .\n  // ?gene_s up:organism/a taxon:9606 .\n  // ?gene_t up:organism/a taxon:10090 .\n  // ?gene_s :memberOf ?og .\n  // ?gene_t :memberOf ?og .\n  // ?gene_s :name ?gene_s_name .\n  // ?gene_t :name ?gene_t_name .\n  // filter (regex(?gene_s_name, \"(^;?ACE2;?)\", \"i\"))\n  // }\n\n  const sparqlJson = await fetchOrthoDBJson('sparql/?query=' + query, false);\n  // console.log('sparql json:', sparqlJson);\n\n  if (sparqlJson.results.bindings.length === 0) {\n    reportError('orthologsNotFound', null, genes);\n  }\n\n  const map = getOrthologMap(genes, sparqlJson);\n\n  let enrichedMap\n  try {\n    enrichedMap = await enrichMap(map.orthologMap, map.sources)\n  } catch(e) {\n    const gene = e.message.split(' ')[0]\n    reportError('orthologsNotFoundInTarget', null, gene, sourceOrg, targetOrgs);\n  }\n\n  let orthologMap = enrichedMap.orthologMap\n  let sources = enrichedMap.sources\n\n  let sourceLocations\n  try {\n    sourceLocations = await fetchLocations(genes, sourceTaxid);\n  } catch (e) {\n    // If no locations were found due to lacking IDs, then force\n    // enrichment and try again\n    enrichedMap = await enrichMap(map.orthologMap, map.sources, true)\n    orthologMap = enrichedMap.orthologMap\n    sources = enrichedMap.sources\n    const ncbiGeneIds = Object.values(sources).map(s => s.ncbiGeneId)\n    sourceLocations = await fetchAnnotsFromEUtils(ncbiGeneIds);\n  }\n\n  let rawTargets\n  let targetLocations\n  try {\n    rawTargets = []\n    Object.entries(orthologMap).forEach(([source, targets]) => {\n      rawTargets = rawTargets.concat(targets)\n    })\n    targetLocations =\n      await fetchLocations(rawTargets, targetTaxid)\n  } catch (e) {\n    // If no locations were found due to lacking IDs, then force\n    // enrichment and try again\n    enrichedMap = await enrichMap(map.orthologMap, map.sources, true)\n    orthologMap = enrichedMap.orthologMap\n\n    rawTargets = []\n    Object.entries(orthologMap).forEach(([source, targets]) => {\n      rawTargets = rawTargets.concat(targets)\n    })\n    sources = enrichedMap.sources\n    targetLocations =\n      await fetchLocations(rawTargets, targetTaxid)\n  }\n\n  const orthologs = []\n\n  Object.entries(orthologMap).forEach(([sourceGene, targetGenes], i) => {\n    const ortholog = []\n\n    targetGenes = sortTargetGenes(targetGenes, sourceGene, sources)\n\n    const sourceLocation =\n      sourceLocations.find(sl => isSuitableMatch(sl, sourceGene)).location\n    const source = {name: sourceGene, location: sourceLocation}\n    ortholog.push(source)\n\n    targetGenes.forEach(targetGene => {\n      const targetName = targetGene.name\n      let targetLocation =\n        targetLocations.find(tl => isSuitableMatch(tl, targetName))\n\n      if (!targetLocation) { targetLocation = targetLocations[i]}\n\n      const target = {name: targetName, location: targetLocation.location}\n      ortholog.push(target)\n    })\n    orthologs.push(ortholog)\n  })\n\n  // console.log('orthologs', orthologs)\n\n  return orthologs\n}\n\n// export {fetchOrthologsFromOrthodb, fetchOrthologsFromOrthodbSparql};\nexport {fetchOrthologsFromOrthodbSparql};\n","import fetchOrthologsFromOma from './oma';\nimport {\n  fetchOrthologsFromOrthodbSparql\n} from './orthodb';\n\nasync function fetchOrthologs(genes, sourceOrg, targetOrgs, api='orthodb') {\n  if (api === 'orthodb') {\n    return await fetchOrthologsFromOrthodbSparql(genes, sourceOrg, targetOrgs);\n  } else if (api === 'oma') {\n    return await fetchOrthologsFromOma(genes, sourceOrg, targetOrgs);\n  }\n}\n\nexport default fetchOrthologs\n","import fetchOrthologs from './homology';\n\n// Enable references to fetchOrthologs when loaded via traditional script tag\nwindow.fetchOrthologs = fetchOrthologs;\n\n// Enable references to fetchOrthologs when imported as an ES6 module\nexport default fetchOrthologs;\n"],"sourceRoot":""}