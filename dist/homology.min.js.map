{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap","webpack:///./node_modules/bottleneck/lib/parser.js","webpack:///./node_modules/bottleneck/lib/Events.js","webpack:///./node_modules/bottleneck/lib/BottleneckError.js","webpack:///./node_modules/bottleneck/lib/RedisConnection.js","webpack:///./node_modules/bottleneck/lib/Scripts.js","webpack:///./node_modules/bottleneck/lib/IORedisConnection.js","webpack:///./src/error.js","webpack:///./src/orthodb.js","webpack:///./node_modules/bottleneck/lib/Bottleneck.js","webpack:///./node_modules/bottleneck/lib/DLList.js","webpack:///./src/index.js","webpack:///./src/homology.js","webpack:///./src/oma.js","webpack:///./node_modules/bottleneck/lib/index.js","webpack:///./node_modules/bottleneck/lib/Queues.js","webpack:///./node_modules/bottleneck/lib/Job.js","webpack:///./node_modules/bottleneck/lib/LocalDatastore.js","webpack:///./node_modules/bottleneck/lib/RedisDatastore.js","webpack:///./node_modules/bottleneck/lib/States.js","webpack:///./node_modules/bottleneck/lib/Sync.js","webpack:///./node_modules/bottleneck/lib/Group.js","webpack:///./node_modules/bottleneck/lib/Batcher.js","webpack:///./src/organism-map.js","webpack:///./src/lib.js"],"names":["root","factory","exports","module","define","amd","a","i","window","installedModules","__webpack_require__","moduleId","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","load","received","defaults","onto","k","ref","v","overwrite","asyncGeneratorStep","gen","resolve","reject","_next","_throw","arg","info","error","done","Promise","then","_asyncToGenerator","fn","self","this","args","arguments","apply","err","undefined","Events","instance","_events","on","once","removeAllListeners","Error","cb","_addListener","status","base","push","length","_this","e","promises","trigger","filter","listener","map","_ref","returned","_x","all","find","x","BottleneckError","RedisConnection","Scripts","parser","options","Redis","eval","terminated","client","createClient","clientOptions","subscriber","duplicate","limiters","shas","ready","_setup","_loadScripts","sub","setMaxListeners","channel","message","_store","onMessage","payload","multi","exec","replies","names","_loadScript","cmd","exec_atomic","channel_client","handler","chan","removeListener","subscribe","_this2","unsubscribe","id","keys","concat","evalsha","flush","len","clearInterval","heartbeat","end","datastore","headers","lua","templates","refs","validate_keys","validate_client","refresh_expiration","process_tick","conditions_check","get_time","allKeys","init","code","group_check","register_client","blacklist_client","update_settings","running","queued","check","submit","register","free","current_reservoir","increment_reservoir","template","Array","h","join","_slicedToArray","arr","_arrayWithHoles","_iterableToArrayLimit","_nonIterableRest","TypeError","_arr","_n","_d","_e","_s","_i","iterator","next","isArray","IORedisConnection","clusterNodes","Cluster","startupNodes","forEach","defineCommand","_ref2","pipeline","_ref2$","_ref3","quit","disconnect","normalizeOrganismName","genusSpecies","split","toUpperCase","slice","reportError","errorObj","gene","org1","org2","summaries","detail","fetchOrthoDBJson","limiter","Bottleneck","minTime","maxConcurrent","async","path","isRest","response","fetch","json","data","fetchLocation","orthodbGene","ncbiGeneId","ogDetails","orthodbGeneId","gene_id","param","entrez","xrefs","xref","type","schedule","result","ginfo","ncbiBase","uids","genomicinfo","chrloc","chrstart","chrstop","fetchGeneLocationFromEUtils","taxidFromOrganismName","taxidByName","findBestOrtholog","orthologId","sourceOrg","targetOrgs","source","targets","hasSourceNameMatch","speciesParam","rawOrtholog","thisOrganism","organism","toLowerCase","genes","geneObj","thisGene","includes","getOrthoDBId","url","splitId","fetchOrtholog","j","scope","ids","sourceGene","sourceLocation","targetLocation","targetGeneName","target","sourceGeneName","nameMatches","targetGene","splitName","getTarget","location","enrichGene","console","log","ensembl","ensemblId","aas","exons","enrichMap","orthologMap","sourceIds","updatedMap","updatedSources","entries","sourceName","updatedTargets","fetchOrthologsFromOrthodb","tasks","fetchOrthologsFromOrthodbSparql","genesClause","sourceTaxid","targetTaxid","query","sparqlJson","seenTargetNames","results","bindings","gene_s_name","sourceId","gene_t","gene_t_name","getOrthologMap","sourceLocations","fetchLocationsFromMyGeneInfo","rawTargets","targetLocations","orthologs","targetGenes","ortholog","sort","b","geneA","geneB","sortTargetGenes","sl","targetName","tl","_toArray","iter","toString","from","_iterableToArray","Job","LocalDatastore","Queues","RedisDatastore","States","Sync","splice","invalid","storeInstanceOptions","storeOptions","_addToQueue","_validateOptions","instanceDefaults","_queues","_scheduled","_states","trackDoneStatus","_limiter","_submitLock","_registerLock","storeDefaults","connection","redisStoreDefaults","localStoreDefaults","unref","clients","clientId","__publish__","__disconnect__","priority","__queued__","isEmpty","__running__","__done__","jobStatus","statusJobs","statusCounts","Math","random","weight","__check__","index","clearTimeout","expiration","job","eventInfo","__free__","empty","error1","wait","clearGlobalState","run","doRun","_clearGlobalState","_run","_free","timeout","setTimeout","doExecute","doExpire","capacity","queue","getFirst","_next2","first","_randomIndex","__register__","success","reservoir","shift","total","_drainOne","drained","newCapacity","_drainAll","catch","shiftAll","doDrop","waitForExecuting","stopDefaults","at","finished","counts","dropWaitingJobs","dropErrorMessage","_dropAllQueued","NUM_PRIORITIES","_receive","_reject","enqueueErrorMessage","stop","blocked","reachedHWM","shifted","strategy","__submit__","LEAK","shiftLastFrom","OVERFLOW_PRIORITY","OVERFLOW","doQueue","doReceive","_ref4","_splice$call2","_ref6","_splice$call4","jobDefaults","rejectOnDrop","promise","task","_args2","_args4","wrapped","withOptions","_this3","__updateSettings__","__currentReservoir__","incr","__incrementReservoir__","default","version","BLOCK","Group","Batcher","highWater","penalty","reservoirRefreshInterval","reservoirRefreshAmount","reservoirIncreaseInterval","reservoirIncreaseAmount","reservoirIncreaseMaximum","heartbeatInterval","clientTimeout","clearDatastore","DLList","decr","_first","_last","node","prev","ref1","ref2","fetchOrthologs","api","omaBase","fetchUniprotId","org","uniprotBase","lines","columns","uniprotId","text","fetchOmaOrthologs","omaUrl","fetchOmaProtein","getOmaIdPrefix","genus","species","proteinId","sourceProtein","rawOrthologs","omaId","omaIdPrefix","theseOrthologs","targetOrgPrefixes","omaid","unshift","canonicalid","chromosome","locus","start","num_priorities","_length","_lists","list","forEachShift","reverse","_sanitizePriority","_resolve","retryCount","sProperty","remove","expected","_assertStatus","chained","passed","doDone","_onFailure","retry","retryAfter","_nextRequest","_lastReservoirRefresh","_lastReservoirIncrease","Date","now","_running","_done","_unblockTime","_startHeartbeat","setInterval","amount","maximum","computeCapacity","_this$storeOptions","min","yieldLoop","_this4","_this5","_this6","time","_this7","_this$storeOptions2","_this8","_this9","conditionsCheck","_this10","_this11","max","queueLength","_this12","strategyIsBlock","isBlocked","computePenalty","_this13","originalId","capacityPriorityCounters","sharedConnection","runScript","prepareInitSettings","__addLimiter__","publish","counter","pos","priorityClient","rawCapacity","indexOf","_data$split2","__removeLimiter__","all_args","__scriptArgs__","__scriptFn__","obj","clear","prepareObject","assign","groupTimeout","convertBool","prepareArray","_ref5","_ref7","_e$message$split2","status1","_jobs","current","reduce","acc","_queue","_this$_queue$shift","_tryToRun","limiterOptions","deleteKey","instances","_startAutoCleanup","deleted","__runCommand__","cursor","found","interval","__groupCheck__","_resetPromise","_lastFlush","_promise","res","rej","_timeout","ret","maxSize","_flush","maxTime","taxid","annots","queryString","replaceAll","getMyGeneInfoQueryString","fetchMyGeneInfo","hits","annot","genomicPos","genomic_pos","chr","symbol","ensemblgene","parseAnnotFromMgiGene"],"mappings":"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","file":"homology.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse {\n\t\tvar a = factory();\n\t\tfor(var i in a) (typeof exports === 'object' ? exports : root)[i] = a[i];\n\t}\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/dist\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 10);\n","\"use strict\";\n\nexports.load = function (received, defaults, onto = {}) {\n  var k, ref, v;\n\n  for (k in defaults) {\n    v = defaults[k];\n    onto[k] = (ref = received[k]) != null ? ref : v;\n  }\n\n  return onto;\n};\n\nexports.overwrite = function (received, defaults, onto = {}) {\n  var k, v;\n\n  for (k in received) {\n    v = received[k];\n\n    if (defaults[k] !== void 0) {\n      onto[k] = v;\n    }\n  }\n\n  return onto;\n};","\"use strict\";\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\n\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\n\nvar Events;\nEvents = class Events {\n  constructor(instance) {\n    this.instance = instance;\n    this._events = {};\n\n    if (this.instance.on != null || this.instance.once != null || this.instance.removeAllListeners != null) {\n      throw new Error(\"An Emitter already exists for this object\");\n    }\n\n    this.instance.on = (name, cb) => {\n      return this._addListener(name, \"many\", cb);\n    };\n\n    this.instance.once = (name, cb) => {\n      return this._addListener(name, \"once\", cb);\n    };\n\n    this.instance.removeAllListeners = (name = null) => {\n      if (name != null) {\n        return delete this._events[name];\n      } else {\n        return this._events = {};\n      }\n    };\n  }\n\n  _addListener(name, status, cb) {\n    var base;\n\n    if ((base = this._events)[name] == null) {\n      base[name] = [];\n    }\n\n    this._events[name].push({\n      cb,\n      status\n    });\n\n    return this.instance;\n  }\n\n  listenerCount(name) {\n    if (this._events[name] != null) {\n      return this._events[name].length;\n    } else {\n      return 0;\n    }\n  }\n\n  trigger(name, ...args) {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      var e, promises;\n\n      try {\n        if (name !== \"debug\") {\n          _this.trigger(\"debug\", `Event triggered: ${name}`, args);\n        }\n\n        if (_this._events[name] == null) {\n          return;\n        }\n\n        _this._events[name] = _this._events[name].filter(function (listener) {\n          return listener.status !== \"none\";\n        });\n        promises = _this._events[name].map(\n        /*#__PURE__*/\n        function () {\n          var _ref = _asyncToGenerator(function* (listener) {\n            var e, returned;\n\n            if (listener.status === \"none\") {\n              return;\n            }\n\n            if (listener.status === \"once\") {\n              listener.status = \"none\";\n            }\n\n            try {\n              returned = typeof listener.cb === \"function\" ? listener.cb(...args) : void 0;\n\n              if (typeof (returned != null ? returned.then : void 0) === \"function\") {\n                return yield returned;\n              } else {\n                return returned;\n              }\n            } catch (error) {\n              e = error;\n\n              if (\"name\" !== \"error\") {\n                _this.trigger(\"error\", e);\n              }\n\n              return null;\n            }\n          });\n\n          return function (_x) {\n            return _ref.apply(this, arguments);\n          };\n        }());\n        return (yield Promise.all(promises)).find(function (x) {\n          return x != null;\n        });\n      } catch (error) {\n        e = error;\n\n        if (\"name\" !== \"error\") {\n          _this.trigger(\"error\", e);\n        }\n\n        return null;\n      }\n    })();\n  }\n\n};\nmodule.exports = Events;","\"use strict\";\n\nvar BottleneckError;\nBottleneckError = class BottleneckError extends Error {};\nmodule.exports = BottleneckError;","\"use strict\";\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\n\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\n\nvar Events, RedisConnection, Scripts, parser;\nparser = require(\"./parser\");\nEvents = require(\"./Events\");\nScripts = require(\"./Scripts\");\n\nRedisConnection = function () {\n  class RedisConnection {\n    constructor(options = {}) {\n      parser.load(options, this.defaults, this);\n\n      if (this.Redis == null) {\n        this.Redis = eval(\"require\")(\"redis\"); // Obfuscated or else Webpack/Angular will try to inline the optional redis module. To override this behavior: pass the redis module to Bottleneck as the 'Redis' option.\n      }\n\n      if (this.Events == null) {\n        this.Events = new Events(this);\n      }\n\n      this.terminated = false;\n\n      if (this.client == null) {\n        this.client = this.Redis.createClient(this.clientOptions);\n      }\n\n      this.subscriber = this.client.duplicate();\n      this.limiters = {};\n      this.shas = {};\n      this.ready = this.Promise.all([this._setup(this.client, false), this._setup(this.subscriber, true)]).then(() => {\n        return this._loadScripts();\n      }).then(() => {\n        return {\n          client: this.client,\n          subscriber: this.subscriber\n        };\n      });\n    }\n\n    _setup(client, sub) {\n      client.setMaxListeners(0);\n      return new this.Promise((resolve, reject) => {\n        client.on(\"error\", e => {\n          return this.Events.trigger(\"error\", e);\n        });\n\n        if (sub) {\n          client.on(\"message\", (channel, message) => {\n            var ref;\n            return (ref = this.limiters[channel]) != null ? ref._store.onMessage(channel, message) : void 0;\n          });\n        }\n\n        if (client.ready) {\n          return resolve();\n        } else {\n          return client.once(\"ready\", resolve);\n        }\n      });\n    }\n\n    _loadScript(name) {\n      return new this.Promise((resolve, reject) => {\n        var payload;\n        payload = Scripts.payload(name);\n        return this.client.multi([[\"script\", \"load\", payload]]).exec((err, replies) => {\n          if (err != null) {\n            return reject(err);\n          }\n\n          this.shas[name] = replies[0];\n          return resolve(replies[0]);\n        });\n      });\n    }\n\n    _loadScripts() {\n      return this.Promise.all(Scripts.names.map(k => {\n        return this._loadScript(k);\n      }));\n    }\n\n    __runCommand__(cmd) {\n      var _this = this;\n\n      return _asyncToGenerator(function* () {\n        yield _this.ready;\n        return new _this.Promise((resolve, reject) => {\n          return _this.client.multi([cmd]).exec_atomic(function (err, replies) {\n            if (err != null) {\n              return reject(err);\n            } else {\n              return resolve(replies[0]);\n            }\n          });\n        });\n      })();\n    }\n\n    __addLimiter__(instance) {\n      return this.Promise.all([instance.channel(), instance.channel_client()].map(channel => {\n        return new this.Promise((resolve, reject) => {\n          var handler;\n\n          handler = chan => {\n            if (chan === channel) {\n              this.subscriber.removeListener(\"subscribe\", handler);\n              this.limiters[channel] = instance;\n              return resolve();\n            }\n          };\n\n          this.subscriber.on(\"subscribe\", handler);\n          return this.subscriber.subscribe(channel);\n        });\n      }));\n    }\n\n    __removeLimiter__(instance) {\n      var _this2 = this;\n\n      return this.Promise.all([instance.channel(), instance.channel_client()].map(\n      /*#__PURE__*/\n      function () {\n        var _ref = _asyncToGenerator(function* (channel) {\n          if (!_this2.terminated) {\n            yield new _this2.Promise((resolve, reject) => {\n              return _this2.subscriber.unsubscribe(channel, function (err, chan) {\n                if (err != null) {\n                  return reject(err);\n                }\n\n                if (chan === channel) {\n                  return resolve();\n                }\n              });\n            });\n          }\n\n          return delete _this2.limiters[channel];\n        });\n\n        return function (_x) {\n          return _ref.apply(this, arguments);\n        };\n      }()));\n    }\n\n    __scriptArgs__(name, id, args, cb) {\n      var keys;\n      keys = Scripts.keys(name, id);\n      return [this.shas[name], keys.length].concat(keys, args, cb);\n    }\n\n    __scriptFn__(name) {\n      return this.client.evalsha.bind(this.client);\n    }\n\n    disconnect(flush = true) {\n      var i, k, len, ref;\n      ref = Object.keys(this.limiters);\n\n      for (i = 0, len = ref.length; i < len; i++) {\n        k = ref[i];\n        clearInterval(this.limiters[k]._store.heartbeat);\n      }\n\n      this.limiters = {};\n      this.terminated = true;\n      this.client.end(flush);\n      this.subscriber.end(flush);\n      return this.Promise.resolve();\n    }\n\n  }\n\n  ;\n  RedisConnection.prototype.datastore = \"redis\";\n  RedisConnection.prototype.defaults = {\n    Redis: null,\n    clientOptions: {},\n    client: null,\n    Promise: Promise,\n    Events: null\n  };\n  return RedisConnection;\n}.call(void 0);\n\nmodule.exports = RedisConnection;","\"use strict\";\n\nvar headers, lua, templates;\nlua = require(\"./lua.json\");\nheaders = {\n  refs: lua[\"refs.lua\"],\n  validate_keys: lua[\"validate_keys.lua\"],\n  validate_client: lua[\"validate_client.lua\"],\n  refresh_expiration: lua[\"refresh_expiration.lua\"],\n  process_tick: lua[\"process_tick.lua\"],\n  conditions_check: lua[\"conditions_check.lua\"],\n  get_time: lua[\"get_time.lua\"]\n};\n\nexports.allKeys = function (id) {\n  return [\n  /*\n  HASH\n  */\n  `b_${id}_settings`,\n  /*\n  HASH\n  job index -> weight\n  */\n  `b_${id}_job_weights`,\n  /*\n  ZSET\n  job index -> expiration\n  */\n  `b_${id}_job_expirations`,\n  /*\n  HASH\n  job index -> client\n  */\n  `b_${id}_job_clients`,\n  /*\n  ZSET\n  client -> sum running\n  */\n  `b_${id}_client_running`,\n  /*\n  HASH\n  client -> num queued\n  */\n  `b_${id}_client_num_queued`,\n  /*\n  ZSET\n  client -> last job registered\n  */\n  `b_${id}_client_last_registered`,\n  /*\n  ZSET\n  client -> last seen\n  */\n  `b_${id}_client_last_seen`];\n};\n\ntemplates = {\n  init: {\n    keys: exports.allKeys,\n    headers: [\"process_tick\"],\n    refresh_expiration: true,\n    code: lua[\"init.lua\"]\n  },\n  group_check: {\n    keys: exports.allKeys,\n    headers: [],\n    refresh_expiration: false,\n    code: lua[\"group_check.lua\"]\n  },\n  register_client: {\n    keys: exports.allKeys,\n    headers: [\"validate_keys\"],\n    refresh_expiration: false,\n    code: lua[\"register_client.lua\"]\n  },\n  blacklist_client: {\n    keys: exports.allKeys,\n    headers: [\"validate_keys\", \"validate_client\"],\n    refresh_expiration: false,\n    code: lua[\"blacklist_client.lua\"]\n  },\n  heartbeat: {\n    keys: exports.allKeys,\n    headers: [\"validate_keys\", \"validate_client\", \"process_tick\"],\n    refresh_expiration: false,\n    code: lua[\"heartbeat.lua\"]\n  },\n  update_settings: {\n    keys: exports.allKeys,\n    headers: [\"validate_keys\", \"validate_client\", \"process_tick\"],\n    refresh_expiration: true,\n    code: lua[\"update_settings.lua\"]\n  },\n  running: {\n    keys: exports.allKeys,\n    headers: [\"validate_keys\", \"validate_client\", \"process_tick\"],\n    refresh_expiration: false,\n    code: lua[\"running.lua\"]\n  },\n  queued: {\n    keys: exports.allKeys,\n    headers: [\"validate_keys\", \"validate_client\"],\n    refresh_expiration: false,\n    code: lua[\"queued.lua\"]\n  },\n  done: {\n    keys: exports.allKeys,\n    headers: [\"validate_keys\", \"validate_client\", \"process_tick\"],\n    refresh_expiration: false,\n    code: lua[\"done.lua\"]\n  },\n  check: {\n    keys: exports.allKeys,\n    headers: [\"validate_keys\", \"validate_client\", \"process_tick\", \"conditions_check\"],\n    refresh_expiration: false,\n    code: lua[\"check.lua\"]\n  },\n  submit: {\n    keys: exports.allKeys,\n    headers: [\"validate_keys\", \"validate_client\", \"process_tick\", \"conditions_check\"],\n    refresh_expiration: true,\n    code: lua[\"submit.lua\"]\n  },\n  register: {\n    keys: exports.allKeys,\n    headers: [\"validate_keys\", \"validate_client\", \"process_tick\", \"conditions_check\"],\n    refresh_expiration: true,\n    code: lua[\"register.lua\"]\n  },\n  free: {\n    keys: exports.allKeys,\n    headers: [\"validate_keys\", \"validate_client\", \"process_tick\"],\n    refresh_expiration: true,\n    code: lua[\"free.lua\"]\n  },\n  current_reservoir: {\n    keys: exports.allKeys,\n    headers: [\"validate_keys\", \"validate_client\", \"process_tick\"],\n    refresh_expiration: false,\n    code: lua[\"current_reservoir.lua\"]\n  },\n  increment_reservoir: {\n    keys: exports.allKeys,\n    headers: [\"validate_keys\", \"validate_client\", \"process_tick\"],\n    refresh_expiration: true,\n    code: lua[\"increment_reservoir.lua\"]\n  }\n};\nexports.names = Object.keys(templates);\n\nexports.keys = function (name, id) {\n  return templates[name].keys(id);\n};\n\nexports.payload = function (name) {\n  var template;\n  template = templates[name];\n  return Array.prototype.concat(headers.refs, template.headers.map(function (h) {\n    return headers[h];\n  }), template.refresh_expiration ? headers.refresh_expiration : \"\", template.code).join(\"\\n\");\n};","\"use strict\";\n\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _nonIterableRest(); }\n\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); }\n\nfunction _iterableToArrayLimit(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\n\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\n\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\n\nvar Events, IORedisConnection, Scripts, parser;\nparser = require(\"./parser\");\nEvents = require(\"./Events\");\nScripts = require(\"./Scripts\");\n\nIORedisConnection = function () {\n  class IORedisConnection {\n    constructor(options = {}) {\n      parser.load(options, this.defaults, this);\n\n      if (this.Redis == null) {\n        this.Redis = eval(\"require\")(\"ioredis\"); // Obfuscated or else Webpack/Angular will try to inline the optional ioredis module. To override this behavior: pass the ioredis module to Bottleneck as the 'Redis' option.\n      }\n\n      if (this.Events == null) {\n        this.Events = new Events(this);\n      }\n\n      this.terminated = false;\n\n      if (this.clusterNodes != null) {\n        this.client = new this.Redis.Cluster(this.clusterNodes, this.clientOptions);\n        this.subscriber = new this.Redis.Cluster(this.clusterNodes, this.clientOptions);\n      } else if (this.client != null && this.client.duplicate == null) {\n        this.subscriber = new this.Redis.Cluster(this.client.startupNodes, this.client.options);\n      } else {\n        if (this.client == null) {\n          this.client = new this.Redis(this.clientOptions);\n        }\n\n        this.subscriber = this.client.duplicate();\n      }\n\n      this.limiters = {};\n      this.ready = this.Promise.all([this._setup(this.client, false), this._setup(this.subscriber, true)]).then(() => {\n        this._loadScripts();\n\n        return {\n          client: this.client,\n          subscriber: this.subscriber\n        };\n      });\n    }\n\n    _setup(client, sub) {\n      client.setMaxListeners(0);\n      return new this.Promise((resolve, reject) => {\n        client.on(\"error\", e => {\n          return this.Events.trigger(\"error\", e);\n        });\n\n        if (sub) {\n          client.on(\"message\", (channel, message) => {\n            var ref;\n            return (ref = this.limiters[channel]) != null ? ref._store.onMessage(channel, message) : void 0;\n          });\n        }\n\n        if (client.status === \"ready\") {\n          return resolve();\n        } else {\n          return client.once(\"ready\", resolve);\n        }\n      });\n    }\n\n    _loadScripts() {\n      return Scripts.names.forEach(name => {\n        return this.client.defineCommand(name, {\n          lua: Scripts.payload(name)\n        });\n      });\n    }\n\n    __runCommand__(cmd) {\n      var _this = this;\n\n      return _asyncToGenerator(function* () {\n        var _, deleted;\n\n        yield _this.ready;\n\n        var _ref = yield _this.client.pipeline([cmd]).exec();\n\n        var _ref2 = _slicedToArray(_ref, 1);\n\n        var _ref2$ = _slicedToArray(_ref2[0], 2);\n\n        _ = _ref2$[0];\n        deleted = _ref2$[1];\n        return deleted;\n      })();\n    }\n\n    __addLimiter__(instance) {\n      return this.Promise.all([instance.channel(), instance.channel_client()].map(channel => {\n        return new this.Promise((resolve, reject) => {\n          return this.subscriber.subscribe(channel, () => {\n            this.limiters[channel] = instance;\n            return resolve();\n          });\n        });\n      }));\n    }\n\n    __removeLimiter__(instance) {\n      var _this2 = this;\n\n      return [instance.channel(), instance.channel_client()].forEach(\n      /*#__PURE__*/\n      function () {\n        var _ref3 = _asyncToGenerator(function* (channel) {\n          if (!_this2.terminated) {\n            yield _this2.subscriber.unsubscribe(channel);\n          }\n\n          return delete _this2.limiters[channel];\n        });\n\n        return function (_x) {\n          return _ref3.apply(this, arguments);\n        };\n      }());\n    }\n\n    __scriptArgs__(name, id, args, cb) {\n      var keys;\n      keys = Scripts.keys(name, id);\n      return [keys.length].concat(keys, args, cb);\n    }\n\n    __scriptFn__(name) {\n      return this.client[name].bind(this.client);\n    }\n\n    disconnect(flush = true) {\n      var i, k, len, ref;\n      ref = Object.keys(this.limiters);\n\n      for (i = 0, len = ref.length; i < len; i++) {\n        k = ref[i];\n        clearInterval(this.limiters[k]._store.heartbeat);\n      }\n\n      this.limiters = {};\n      this.terminated = true;\n\n      if (flush) {\n        return this.Promise.all([this.client.quit(), this.subscriber.quit()]);\n      } else {\n        this.client.disconnect();\n        this.subscriber.disconnect();\n        return this.Promise.resolve();\n      }\n    }\n\n  }\n\n  ;\n  IORedisConnection.prototype.datastore = \"ioredis\";\n  IORedisConnection.prototype.defaults = {\n    Redis: null,\n    clientOptions: {},\n    clusterNodes: null,\n    client: null,\n    Promise: Promise,\n    Events: null\n  };\n  return IORedisConnection;\n}.call(void 0);\n\nmodule.exports = IORedisConnection;","/**\n * Converts an all-lowercase name to uppercase genus, lowercase species\n * Example: mus musculus -> Mus musculus\n */\nfunction normalizeOrganismName(name) {\n  var genusSpecies, genus, species;\n  genusSpecies = name.split(' ');\n\n  // e.g. mus -> Mus\n  genus = genusSpecies[0][0].toUpperCase() + genusSpecies[0].slice(1,);\n\n  // Account for subspecies name, e.g. Canis lupus familiaris\n  species = genusSpecies.slice(1,).join(' ');\n\n  return genus + ' ' + species;\n}\n\nfunction reportError(error, errorObj=null, gene=null, org1=null, org2=null) {\n  var summaries, summary, detail;\n\n  if (org1 !== null) org1 = normalizeOrganismName(org1);\n  if (org2 !== null) org2 = normalizeOrganismName(org2[0]);\n\n  summaries = {\n      'geneNotFound': `Gene \"${gene}\" not found in source organism \"${org1}\"`,\n      'orthologsNotFound': `Orthologs not found for gene \"${gene}\"`,\n      'orthologsNotFoundInTarget':\n        `Orthologs not found for gene \"${gene}\" in target organism \"${org2}\"`\n  }\n  detail = errorObj ? `<br/><small>${errorObj.message}</small>` : '';\n  summary = summaries[error] + detail\n  throw new Error(summary);\n}\n\nexport {reportError}","/**\n* @fileoverview Client library for OrthoDB\n* API docs: https://www.orthodb.org/?page=api\n*\n* This module supports fetching orthologs from OMA.  All functions here\n* support the single exported function `fetchOrthologsFromOrthoDb`.\n*/\n\nimport Bottleneck from 'bottleneck';\n\nimport taxidByName from './organism-map';\nimport {reportError} from './error';\nimport {fetchLocationsFromMyGeneInfo} from './lib';\n\nvar limiter = new Bottleneck({\n  minTime: 333,\n  maxConcurrent: 3\n});\n\n// OrthoDB does not support CORS.  Homology API on Firebase proxies OrthoDB and\n// supports CORS.  This enables client-side web requests to the OrthoDB API.\n//\n// var orthodbBase = 'https://www.orthodb.org/';\n// var orthodbBase = 'https://homology-api.firebaseapp.com/orthodb/';\n// var orthodbBase = 'http://localhost:5000/orthodb/';\nvar orthodbBase = 'http://localhost:5001/homology-api/us-central1/app/orthodb/'\n\nvar apiKey = '&api_key=e7ce8adecd69d0457df7ec2ccbb704c4e709';\n\nvar ncbiBase =\n  'https://eutils.ncbi.nlm.nih.gov/entrez/eutils/esummary.fcgi' +\n  '?db=gene&retmode=json' + apiKey;\n\n/**\n * Get JSON response from OrthoDB API\n */\nexport async function fetchOrthoDBJson(path, isRest=true) {\n  var response = await fetch(orthodbBase + path);\n  var json = await response.json();\n  if (isRest) {\n    return json.data;\n  } else {\n    return json;\n  }\n}\n\n/**\n * Get genomic coordinates of a gene using its NCBI Gene ID\n */\nasync function fetchGeneLocationFromEUtils(ncbiGeneId) {\n  var response, data, result, ginfo, location;\n  // Example:\n  // https://eutils.ncbi.nlm.nih.gov/entrez/eutils/esummary.fcgi?db=gene&retmode=json&id=3565955\n  response = await fetch(ncbiBase + '&id=' + ncbiGeneId);\n  data = await response.json();\n  result = data.result;\n  ginfo = result[result.uids[0]].genomicinfo[0];\n  location = ginfo.chrloc + ':' + ginfo.chrstart + '-' + ginfo.chrstop;\n  return location;\n}\n\nasync function fetchLocation(orthodbGene) {\n  var ncbiGeneId, ogDetails, location,\n    orthodbGeneId = orthodbGene.gene_id.param;\n\n  // Example:\n  // https://homology-api.firebaseapp.com/orthodb/ogdetails?id=6239_0:0008da\n  ogDetails = await fetchOrthoDBJson('ogdetails?id=' + orthodbGeneId);\n\n  if ('entrez' in ogDetails) {\n    ncbiGeneId = ogDetails.entrez[0].id;\n  } else {\n    // Occurs in Drosophila melanogaster, e.g.\n    // https://homology-api.firebaseapp.com/orthodb/ogdetails?id=7227_0:000534\n    ogDetails.xrefs.forEach(xref => {\n      if (xref.type === 'NCBIgene') ncbiGeneId = xref.name;\n    });\n  }\n\n  location = await limiter.schedule(() => fetchGeneLocationFromEUtils(ncbiGeneId));\n  return location;\n}\n\nfunction taxidFromOrganismName(name) {\n  return name in taxidByName ? taxidByName[name] : 'all';\n}\n\n/**\n * See if an ortholog matches a queried organism, and how well it matches\n */\nasync function findBestOrtholog(orthologId, gene, sourceOrg, targetOrgs) {\n  var source, rawOrthologs,\n    targets = [],\n    hasSourceNameMatch = false;\n\n  const sourceTaxid = taxidFromOrganismName(sourceOrg);\n  const targetTaxid = taxidFromOrganismName(targetOrgs[0]);\n  const speciesParam = sourceTaxid + ',' + targetTaxid;\n\n  // Example:\n  // https://homology-api.firebaseapp.com/orthodb/orthologs?id=1269806at2759&species=all\n  rawOrthologs = await fetchOrthoDBJson(`orthologs?id=${orthologId}&species=${speciesParam}`);\n\n  rawOrthologs.forEach(rawOrtholog => {\n\n    // Is this ortholog record for the source organism?\n    var thisOrganism = rawOrtholog.organism.name.toLowerCase();\n    if (sourceOrg === thisOrganism) {\n      source = rawOrtholog;\n\n      // Do any genes in the record have a name matching the queried gene?\n      rawOrtholog.genes.forEach(geneObj => {\n        var thisGene = geneObj.gene_id.id.toLowerCase();\n        if (gene.toLowerCase() === thisGene) {\n          hasSourceNameMatch = true;\n        }\n      });\n    }\n\n    if (targetOrgs.includes(thisOrganism)) targets.push(rawOrtholog);\n  });\n\n  return [source, targets, hasSourceNameMatch];\n}\n\nfunction getTargetGene(target, sourceGeneName) {\n  var nameMatches = target.genes.filter(gene => {\n    return gene.gene_id.id.toLowerCase() === sourceGeneName.toLowerCase();\n  });\n  if (nameMatches.length === 0) {\n    return target.genes[0];\n  } else {\n    return nameMatches[0];\n  }\n}\n\n/**\n * E.g. http://purl.orthodb.org/odbgene/6239_0_000f12 -> 6239_0:000f12\n */\nfunction getOrthoDBId(url) {\n  const splitId = url.split('/').slice(-1)[0].split('_')\n  return splitId[0] + '_' + splitId[1] + ':' + splitId[2]\n}\n\nasync function getTarget(targets, gene) {\n  // TODO: Return 1-to-many mappings\n  // Example with many target hits this (over)simplifies:\n  // http://eweitz.github.io/ideogram/comparative-genomics?org=homo-sapiens&org2=mus-musculus&source=orthodb&gene=SAP30\n  var targetGene = getTargetGene(targets[0], gene)\n  var targetLocation = await fetchLocation(targetGene);\n\n  var splitName = targetGene.gene_id.id.split(';');\n  var nameIndex = (splitName.length > 1) ? 1 : 0;\n  var targetGeneName = splitName[nameIndex];\n\n  return [targetLocation, targetGeneName];\n}\n\nasync function fetchOrtholog(gene, sourceOrg, targetOrgs) {\n  var ortholog, ids, j, id, source, gene, scope, ids, sourceGene,\n    hasSourceNameMatch = false,\n    targets = [],\n    targetOrg = targetOrgs[0],\n    targetTaxid = taxidFromOrganismName(targetOrg),\n    sourceTaxid = taxidFromOrganismName(sourceOrg)\n\n  // 2759 is the NCBI Taxonomy ID for Eukaryota (eukaryote)\n  // https://www.ncbi.nlm.nih.gov/Taxonomy/Browser/wwwtax.cgi?id=2759\n  scope = \"level=2759&species=\" + targetTaxid + ',' + sourceTaxid;\n\n  // Example:\n  // https://homology-api.firebaseapp.com/orthodb/search?query=NFYA&level=2759&species=2759\n  ids = await fetchOrthoDBJson('search?query=' + gene + '&' + scope);\n\n  // Iterate through returned ortholog IDs\n  // Prefer orthologous pairs that have a gene name matching the queried gene\n  for (j = 0; j < ids.length; j++) {\n    id = ids[j];\n    [source, targets, hasSourceNameMatch] =\n      await findBestOrtholog(id, gene, sourceOrg, targetOrgs);\n    if (hasSourceNameMatch) break;\n  }\n\n  if (typeof source === 'undefined') {\n    reportError('orthologsNotFound', null, gene, sourceOrg, targetOrgs);\n  }\n\n  sourceGene = source.genes.filter(geneObj => {\n    var thisGene = geneObj.gene_id.id.toLowerCase();\n    return gene.toLowerCase() === thisGene;\n  })[0];\n\n  if (typeof sourceGene === 'undefined') {\n   reportError('geneNotFound', null, gene, sourceOrg);\n  }\n  var sourceLocation = await fetchLocation(sourceGene);\n\n  if (targets.length === 0) {\n    reportError('orthologsNotFoundInTarget', null, gene, sourceOrg, targetOrgs);\n  }\n\n  var [targetLocation, targetGeneName] = await getTarget(targets, gene);\n\n  // TODO:\n  //  * Uncomment this when multi-target orthology support is implemented\n  //  * Implement exponential backoff and jitter to address rate limits\n  // var locations = await Promise.all(targets.map(async (target) => {\n  //   return await Promise.all(target.genes.map(async (gene) => {\n  //     return fetchLocation(gene);\n  //   }));\n  // }));\n  // locations = locations[0];\n  // locations.unshift(sourceLocation); // prepend to source to target array\n\n  ortholog = [\n    {gene: gene, location: sourceLocation},\n    {gene: targetGeneName, location: targetLocation}\n  ];\n\n  return ortholog;\n}\n\n/**\n * Get genomic locations of orthologs from OrthoDB\n *\n * For genes in a source organism, find orthologs in target organisms and\n * return the genomic coordinates of the source gene and orthologous genes.\n *\n * Example:\n * fetchOrthologsFromOrthodb(\n *  ['NFYA'],\n *  'homo-sapiens',\n *  ['caenorhabditis-elegans']\n * );\n *\n * @param {Array} genes Gene name\n * @param {String} sourceOrg Source organism name\n * @param {Array<String>} targetOrgs List of target organism names\n */\nasync function fetchOrthologsFromOrthodb(genes, sourceOrg, targetOrgs) {\n  var tasks = genes.map(gene => fetchOrtholog(gene, sourceOrg, targetOrgs));\n  return Promise.all(tasks);\n}\n\n/** Deduplicates gene names in a list of results from SPARQL query */\nfunction getOrthologMap(genes, sparqlJson) {\n\n  const orthologMap = {}\n  const seenTargetNames = {}\n  genes.forEach(gene => {\n    seenTargetNames[gene] = []\n    orthologMap[gene] = []\n  })\n\n  const sourceIds = {}\n\n  sparqlJson.results.bindings.forEach(result => {\n    const source = result.gene_s_name.value\n    const sourceId = getOrthoDBId(result.gene_t.value)\n    if (orthologMap[source].length > 0) sourceIds[source] = {id: sourceId}\n\n    const name = result.gene_t_name.value;\n    const id = getOrthoDBId(result.gene_t.value)\n    if (!seenTargetNames[source].includes(name)) {\n      seenTargetNames[source].push(name)\n      orthologMap[source].push({name, id})\n    }\n  })\n\n  return {orthologMap, sourceIds}\n}\n\n/**\n * Sort orthologs by name similarity to source gene\n *\n * A given gene (source gene) can have multiple target genes (orthologs).\n *\n */\nfunction sortTargetGenes(sourceGene, targetGenes) {\n  console.log('sourceGene, targetGenes', sourceGene, targetGenes)\n  sourceGene = sourceGene.toLowerCase()\n  return targetGenes.sort((a, b) => {\n    const geneA = a.name.toLowerCase()\n    const geneB = b.name.toLowerCase()\n    if (geneA !== sourceGene && geneB !== sourceGene) {\n\n    }\n    if (geneA === sourceGene) return -1\n    if (geneB === sourceGene) return 1\n  })\n}\n\n/**\n * Add Ensembl ID, # amino acids, and # exons to a gene.\n */\nasync function enrichGene(gene) {\n  const ogDetails = await fetchOrthoDBJson('ogdetails?id=' + gene.id);\n  console.log('ogDetails for gene', ogDetails)\n  if (ogDetails.ensembl) {\n    gene.ensemblId = ogDetails.ensembl[0].id\n    gene.aas = ogDetails.aas // length in amino acids\n    gene.exons = ogDetails.exons // number of exons\n  }\n}\n\n/**\n * Add Ensembl IDs, # amino acids, and # exons to source and target genes.\n */\nasync function enrichMap(orthologMap, sourceIds) {\n  const updatedMap = {}\n  const updatedSources = {}\n\n  // Parallelizes as described in https://medium.com/@antonioval/6315c3225838\n  // (but without library advertised there).\n  await Promise.all(\n    Object.entries(orthologMap).map(async ([sourceName, targets]) => {\n      const source = sourceIds[sourceName]\n      updatedSources[sourceName] = await enrichGene(source)\n\n      // Parallelize OrthoDB REST API requests\n      const promises = targets.map(async target => await enrichGene(target))\n      const updatedTargets = await Promise.all(promises)\n\n      updatedMap[source] = updatedTargets\n    })\n  )\n\n  console.log('updatedSources', updatedSources)\n\n  return {updatedMap, updatedSources}\n}\n\nasync function fetchOrthologsFromOrthodbSparql(genes, sourceOrg, targetOrgs) {\n  const genesClause = genes.join('%7C') // URL encoding for | (i.e. OR)\n\n  // TODO: Support multiple target organisms\n  const sourceTaxid = taxidByName[sourceOrg]\n  const targetTaxid = taxidByName[targetOrgs[0]]\n\n  console.log('sourceOrg', sourceOrg)\n\n  const query =\n    'sparql/?query=prefix+%3A+%3Chttp%3A%2F%2Fpurl.orthodb.org%2F%3E%0D%0A' +\n    'select+*%0D%0A' +\n    'where+%7B%0D%0A' +\n    '%3Fog+a+%3AOrthoGroup.%0D%0A' +\n    '%3Fgene_s+a+%3AGene.%0D%0A' + // source gene\n    '%3Fgene_t+a+%3AGene.%0D%0A' + // target gene\n    `%3Fgene_s+up%3Aorganism%2Fa+taxon%3A${sourceTaxid}.%0D%0A` +\n    `%3Fgene_t+up%3Aorganism%2Fa+taxon%3A${targetTaxid}.%0D%0A` +\n    '%3Fgene_s+%3AmemberOf+%3Fog.%0D%0A' +\n    '%3Fgene_t+%3AmemberOf+%3Fog.%0D%0A' +\n    '%3Fgene_s+%3Aname+%3Fgene_s_name.%0D%0A' +\n    '%3Fgene_t+%3Aname+%3Fgene_t_name.%0D%0A' +\n    `filter+%28regex%28%3Fgene_s_name%2C+%22%5E%28${genesClause}%29%24%22%2C+%22i%22%29%29%0D%0A` +\n    '%7D';\n  const sparqlJson = await fetchOrthoDBJson(query, false);\n  console.log('sparql json:', sparqlJson);\n\n  let {orthologMap, sourceIds} = getOrthologMap(genes, sparqlJson);\n\n  console.log('orthologMap, before addEnsemblIds: ', orthologMap)\n\n  orthologMap, sourceIds = await enrichMap(orthologMap, sourceIds)\n\n  console.log('orthologMap, after enrichMap: ', enrichMap)\n\n  const sourceLocations = await fetchLocationsFromMyGeneInfo(genes, sourceTaxid);\n\n  let rawTargets = []\n  Object.entries(orthologMap).forEach(([source, targets]) => {\n    rawTargets = rawTargets.concat(targets)\n  })\n\n  const targetLocations =\n    await fetchLocationsFromMyGeneInfo(rawTargets, targetTaxid)\n\n  const orthologs = []\n\n  Object.entries(orthologMap).forEach(([sourceGene, targetGenes]) => {\n    const ortholog = []\n\n    console.log('targets, unsorted', targetGenes)\n    targetGenes = sortTargetGenes(sourceGene, targetGenes)\n    console.log('targets, sorted', targetGenes)\n\n    const sourceLocation =\n      sourceLocations.find(sl => sl.name === sourceGene).location\n    console.log('sourceLocations', sourceLocations)\n    const source = {gene: sourceGene, location: sourceLocation}\n    ortholog.push(source)\n    console.log('source', source)\n    targetGenes.forEach(targetGene => {\n      const targetName = targetGene.name\n      let targetLocation =\n        targetLocations.find(tl => tl.name === targetName)\n\n      if (!targetLocation) { targetLocation = targetLocations[0]}\n\n      const target = {gene: targetName, location: targetLocation.location}\n      ortholog.push(target)\n    })\n    orthologs.push(ortholog)\n  })\n\n  console.log(orthologs)\n\n  return orthologs\n}\n\nexport {fetchOrthologsFromOrthodb, fetchOrthologsFromOrthodbSparql};\n","\"use strict\";\n\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _nonIterableRest(); }\n\nfunction _iterableToArrayLimit(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\n\nfunction _toArray(arr) { return _arrayWithHoles(arr) || _iterableToArray(arr) || _nonIterableRest(); }\n\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); }\n\nfunction _iterableToArray(iter) { if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === \"[object Arguments]\") return Array.from(iter); }\n\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\n\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\n\nvar Bottleneck,\n    DEFAULT_PRIORITY,\n    Events,\n    Job,\n    LocalDatastore,\n    NUM_PRIORITIES,\n    Queues,\n    RedisDatastore,\n    States,\n    Sync,\n    parser,\n    splice = [].splice;\nNUM_PRIORITIES = 10;\nDEFAULT_PRIORITY = 5;\nparser = require(\"./parser\");\nQueues = require(\"./Queues\");\nJob = require(\"./Job\");\nLocalDatastore = require(\"./LocalDatastore\");\nRedisDatastore = require(\"./RedisDatastore\");\nEvents = require(\"./Events\");\nStates = require(\"./States\");\nSync = require(\"./Sync\");\n\nBottleneck = function () {\n  class Bottleneck {\n    constructor(options = {}, ...invalid) {\n      var storeInstanceOptions, storeOptions;\n      this._addToQueue = this._addToQueue.bind(this);\n\n      this._validateOptions(options, invalid);\n\n      parser.load(options, this.instanceDefaults, this);\n      this._queues = new Queues(NUM_PRIORITIES);\n      this._scheduled = {};\n      this._states = new States([\"RECEIVED\", \"QUEUED\", \"RUNNING\", \"EXECUTING\"].concat(this.trackDoneStatus ? [\"DONE\"] : []));\n      this._limiter = null;\n      this.Events = new Events(this);\n      this._submitLock = new Sync(\"submit\", this.Promise);\n      this._registerLock = new Sync(\"register\", this.Promise);\n      storeOptions = parser.load(options, this.storeDefaults, {});\n\n      this._store = function () {\n        if (this.datastore === \"redis\" || this.datastore === \"ioredis\" || this.connection != null) {\n          storeInstanceOptions = parser.load(options, this.redisStoreDefaults, {});\n          return new RedisDatastore(this, storeOptions, storeInstanceOptions);\n        } else if (this.datastore === \"local\") {\n          storeInstanceOptions = parser.load(options, this.localStoreDefaults, {});\n          return new LocalDatastore(this, storeOptions, storeInstanceOptions);\n        } else {\n          throw new Bottleneck.prototype.BottleneckError(`Invalid datastore type: ${this.datastore}`);\n        }\n      }.call(this);\n\n      this._queues.on(\"leftzero\", () => {\n        var ref;\n        return (ref = this._store.heartbeat) != null ? typeof ref.ref === \"function\" ? ref.ref() : void 0 : void 0;\n      });\n\n      this._queues.on(\"zero\", () => {\n        var ref;\n        return (ref = this._store.heartbeat) != null ? typeof ref.unref === \"function\" ? ref.unref() : void 0 : void 0;\n      });\n    }\n\n    _validateOptions(options, invalid) {\n      if (!(options != null && typeof options === \"object\" && invalid.length === 0)) {\n        throw new Bottleneck.prototype.BottleneckError(\"Bottleneck v2 takes a single object argument. Refer to https://github.com/SGrondin/bottleneck#upgrading-to-v2 if you're upgrading from Bottleneck v1.\");\n      }\n    }\n\n    ready() {\n      return this._store.ready;\n    }\n\n    clients() {\n      return this._store.clients;\n    }\n\n    channel() {\n      return `b_${this.id}`;\n    }\n\n    channel_client() {\n      return `b_${this.id}_${this._store.clientId}`;\n    }\n\n    publish(message) {\n      return this._store.__publish__(message);\n    }\n\n    disconnect(flush = true) {\n      return this._store.__disconnect__(flush);\n    }\n\n    chain(_limiter) {\n      this._limiter = _limiter;\n      return this;\n    }\n\n    queued(priority) {\n      return this._queues.queued(priority);\n    }\n\n    clusterQueued() {\n      return this._store.__queued__();\n    }\n\n    empty() {\n      return this.queued() === 0 && this._submitLock.isEmpty();\n    }\n\n    running() {\n      return this._store.__running__();\n    }\n\n    done() {\n      return this._store.__done__();\n    }\n\n    jobStatus(id) {\n      return this._states.jobStatus(id);\n    }\n\n    jobs(status) {\n      return this._states.statusJobs(status);\n    }\n\n    counts() {\n      return this._states.statusCounts();\n    }\n\n    _randomIndex() {\n      return Math.random().toString(36).slice(2);\n    }\n\n    check(weight = 1) {\n      return this._store.__check__(weight);\n    }\n\n    _clearGlobalState(index) {\n      if (this._scheduled[index] != null) {\n        clearTimeout(this._scheduled[index].expiration);\n        delete this._scheduled[index];\n        return true;\n      } else {\n        return false;\n      }\n    }\n\n    _free(index, job, options, eventInfo) {\n      var _this = this;\n\n      return _asyncToGenerator(function* () {\n        var e, running;\n\n        try {\n          var _ref = yield _this._store.__free__(index, options.weight);\n\n          running = _ref.running;\n\n          _this.Events.trigger(\"debug\", `Freed ${options.id}`, eventInfo);\n\n          if (running === 0 && _this.empty()) {\n            return _this.Events.trigger(\"idle\");\n          }\n        } catch (error1) {\n          e = error1;\n          return _this.Events.trigger(\"error\", e);\n        }\n      })();\n    }\n\n    _run(index, job, wait) {\n      var clearGlobalState, free, run;\n      job.doRun();\n      clearGlobalState = this._clearGlobalState.bind(this, index);\n      run = this._run.bind(this, index, job);\n      free = this._free.bind(this, index, job);\n      return this._scheduled[index] = {\n        timeout: setTimeout(() => {\n          return job.doExecute(this._limiter, clearGlobalState, run, free);\n        }, wait),\n        expiration: job.options.expiration != null ? setTimeout(function () {\n          return job.doExpire(clearGlobalState, run, free);\n        }, wait + job.options.expiration) : void 0,\n        job: job\n      };\n    }\n\n    _drainOne(capacity) {\n      return this._registerLock.schedule(() => {\n        var args, index, next, options, queue;\n\n        if (this.queued() === 0) {\n          return this.Promise.resolve(null);\n        }\n\n        queue = this._queues.getFirst();\n\n        var _next2 = next = queue.first();\n\n        options = _next2.options;\n        args = _next2.args;\n\n        if (capacity != null && options.weight > capacity) {\n          return this.Promise.resolve(null);\n        }\n\n        this.Events.trigger(\"debug\", `Draining ${options.id}`, {\n          args,\n          options\n        });\n        index = this._randomIndex();\n        return this._store.__register__(index, options.weight, options.expiration).then(({\n          success,\n          wait,\n          reservoir\n        }) => {\n          var empty;\n          this.Events.trigger(\"debug\", `Drained ${options.id}`, {\n            success,\n            args,\n            options\n          });\n\n          if (success) {\n            queue.shift();\n            empty = this.empty();\n\n            if (empty) {\n              this.Events.trigger(\"empty\");\n            }\n\n            if (reservoir === 0) {\n              this.Events.trigger(\"depleted\", empty);\n            }\n\n            this._run(index, next, wait);\n\n            return this.Promise.resolve(options.weight);\n          } else {\n            return this.Promise.resolve(null);\n          }\n        });\n      });\n    }\n\n    _drainAll(capacity, total = 0) {\n      return this._drainOne(capacity).then(drained => {\n        var newCapacity;\n\n        if (drained != null) {\n          newCapacity = capacity != null ? capacity - drained : capacity;\n          return this._drainAll(newCapacity, total + drained);\n        } else {\n          return this.Promise.resolve(total);\n        }\n      }).catch(e => {\n        return this.Events.trigger(\"error\", e);\n      });\n    }\n\n    _dropAllQueued(message) {\n      return this._queues.shiftAll(function (job) {\n        return job.doDrop({\n          message\n        });\n      });\n    }\n\n    stop(options = {}) {\n      var done, waitForExecuting;\n      options = parser.load(options, this.stopDefaults);\n\n      waitForExecuting = at => {\n        var finished;\n\n        finished = () => {\n          var counts;\n          counts = this._states.counts;\n          return counts[0] + counts[1] + counts[2] + counts[3] === at;\n        };\n\n        return new this.Promise((resolve, reject) => {\n          if (finished()) {\n            return resolve();\n          } else {\n            return this.on(\"done\", () => {\n              if (finished()) {\n                this.removeAllListeners(\"done\");\n                return resolve();\n              }\n            });\n          }\n        });\n      };\n\n      done = options.dropWaitingJobs ? (this._run = function (index, next) {\n        return next.doDrop({\n          message: options.dropErrorMessage\n        });\n      }, this._drainOne = () => {\n        return this.Promise.resolve(null);\n      }, this._registerLock.schedule(() => {\n        return this._submitLock.schedule(() => {\n          var k, ref, v;\n          ref = this._scheduled;\n\n          for (k in ref) {\n            v = ref[k];\n\n            if (this.jobStatus(v.job.options.id) === \"RUNNING\") {\n              clearTimeout(v.timeout);\n              clearTimeout(v.expiration);\n              v.job.doDrop({\n                message: options.dropErrorMessage\n              });\n            }\n          }\n\n          this._dropAllQueued(options.dropErrorMessage);\n\n          return waitForExecuting(0);\n        });\n      })) : this.schedule({\n        priority: NUM_PRIORITIES - 1,\n        weight: 0\n      }, () => {\n        return waitForExecuting(1);\n      });\n\n      this._receive = function (job) {\n        return job._reject(new Bottleneck.prototype.BottleneckError(options.enqueueErrorMessage));\n      };\n\n      this.stop = () => {\n        return this.Promise.reject(new Bottleneck.prototype.BottleneckError(\"stop() has already been called\"));\n      };\n\n      return done;\n    }\n\n    _addToQueue(job) {\n      var _this2 = this;\n\n      return _asyncToGenerator(function* () {\n        var args, blocked, error, options, reachedHWM, shifted, strategy;\n        args = job.args;\n        options = job.options;\n\n        try {\n          var _ref2 = yield _this2._store.__submit__(_this2.queued(), options.weight);\n\n          reachedHWM = _ref2.reachedHWM;\n          blocked = _ref2.blocked;\n          strategy = _ref2.strategy;\n        } catch (error1) {\n          error = error1;\n\n          _this2.Events.trigger(\"debug\", `Could not queue ${options.id}`, {\n            args,\n            options,\n            error\n          });\n\n          job.doDrop({\n            error\n          });\n          return false;\n        }\n\n        if (blocked) {\n          job.doDrop();\n          return true;\n        } else if (reachedHWM) {\n          shifted = strategy === Bottleneck.prototype.strategy.LEAK ? _this2._queues.shiftLastFrom(options.priority) : strategy === Bottleneck.prototype.strategy.OVERFLOW_PRIORITY ? _this2._queues.shiftLastFrom(options.priority + 1) : strategy === Bottleneck.prototype.strategy.OVERFLOW ? job : void 0;\n\n          if (shifted != null) {\n            shifted.doDrop();\n          }\n\n          if (shifted == null || strategy === Bottleneck.prototype.strategy.OVERFLOW) {\n            if (shifted == null) {\n              job.doDrop();\n            }\n\n            return reachedHWM;\n          }\n        }\n\n        job.doQueue(reachedHWM, blocked);\n\n        _this2._queues.push(job);\n\n        yield _this2._drainAll();\n        return reachedHWM;\n      })();\n    }\n\n    _receive(job) {\n      if (this._states.jobStatus(job.options.id) != null) {\n        job._reject(new Bottleneck.prototype.BottleneckError(`A job with the same id already exists (id=${job.options.id})`));\n\n        return false;\n      } else {\n        job.doReceive();\n        return this._submitLock.schedule(this._addToQueue, job);\n      }\n    }\n\n    submit(...args) {\n      var cb, fn, job, options, ref, ref1, task;\n\n      if (typeof args[0] === \"function\") {\n        var _ref3, _ref4, _splice$call, _splice$call2;\n\n        ref = args, (_ref3 = ref, _ref4 = _toArray(_ref3), fn = _ref4[0], args = _ref4.slice(1), _ref3), (_splice$call = splice.call(args, -1), _splice$call2 = _slicedToArray(_splice$call, 1), cb = _splice$call2[0], _splice$call);\n        options = parser.load({}, this.jobDefaults);\n      } else {\n        var _ref5, _ref6, _splice$call3, _splice$call4;\n\n        ref1 = args, (_ref5 = ref1, _ref6 = _toArray(_ref5), options = _ref6[0], fn = _ref6[1], args = _ref6.slice(2), _ref5), (_splice$call3 = splice.call(args, -1), _splice$call4 = _slicedToArray(_splice$call3, 1), cb = _splice$call4[0], _splice$call3);\n        options = parser.load(options, this.jobDefaults);\n      }\n\n      task = (...args) => {\n        return new this.Promise(function (resolve, reject) {\n          return fn(...args, function (...args) {\n            return (args[0] != null ? reject : resolve)(args);\n          });\n        });\n      };\n\n      job = new Job(task, args, options, this.jobDefaults, this.rejectOnDrop, this.Events, this._states, this.Promise);\n      job.promise.then(function (args) {\n        return typeof cb === \"function\" ? cb(...args) : void 0;\n      }).catch(function (args) {\n        if (Array.isArray(args)) {\n          return typeof cb === \"function\" ? cb(...args) : void 0;\n        } else {\n          return typeof cb === \"function\" ? cb(args) : void 0;\n        }\n      });\n      return this._receive(job);\n    }\n\n    schedule(...args) {\n      var job, options, task;\n\n      if (typeof args[0] === \"function\") {\n        var _args = args;\n\n        var _args2 = _toArray(_args);\n\n        task = _args2[0];\n        args = _args2.slice(1);\n        options = {};\n      } else {\n        var _args3 = args;\n\n        var _args4 = _toArray(_args3);\n\n        options = _args4[0];\n        task = _args4[1];\n        args = _args4.slice(2);\n      }\n\n      job = new Job(task, args, options, this.jobDefaults, this.rejectOnDrop, this.Events, this._states, this.Promise);\n\n      this._receive(job);\n\n      return job.promise;\n    }\n\n    wrap(fn) {\n      var schedule, wrapped;\n      schedule = this.schedule.bind(this);\n\n      wrapped = function wrapped(...args) {\n        return schedule(fn.bind(this), ...args);\n      };\n\n      wrapped.withOptions = function (options, ...args) {\n        return schedule(options, fn, ...args);\n      };\n\n      return wrapped;\n    }\n\n    updateSettings(options = {}) {\n      var _this3 = this;\n\n      return _asyncToGenerator(function* () {\n        yield _this3._store.__updateSettings__(parser.overwrite(options, _this3.storeDefaults));\n        parser.overwrite(options, _this3.instanceDefaults, _this3);\n        return _this3;\n      })();\n    }\n\n    currentReservoir() {\n      return this._store.__currentReservoir__();\n    }\n\n    incrementReservoir(incr = 0) {\n      return this._store.__incrementReservoir__(incr);\n    }\n\n  }\n\n  ;\n  Bottleneck.default = Bottleneck;\n  Bottleneck.Events = Events;\n  Bottleneck.version = Bottleneck.prototype.version = require(\"./version.json\").version;\n  Bottleneck.strategy = Bottleneck.prototype.strategy = {\n    LEAK: 1,\n    OVERFLOW: 2,\n    OVERFLOW_PRIORITY: 4,\n    BLOCK: 3\n  };\n  Bottleneck.BottleneckError = Bottleneck.prototype.BottleneckError = require(\"./BottleneckError\");\n  Bottleneck.Group = Bottleneck.prototype.Group = require(\"./Group\");\n  Bottleneck.RedisConnection = Bottleneck.prototype.RedisConnection = require(\"./RedisConnection\");\n  Bottleneck.IORedisConnection = Bottleneck.prototype.IORedisConnection = require(\"./IORedisConnection\");\n  Bottleneck.Batcher = Bottleneck.prototype.Batcher = require(\"./Batcher\");\n  Bottleneck.prototype.jobDefaults = {\n    priority: DEFAULT_PRIORITY,\n    weight: 1,\n    expiration: null,\n    id: \"<no-id>\"\n  };\n  Bottleneck.prototype.storeDefaults = {\n    maxConcurrent: null,\n    minTime: 0,\n    highWater: null,\n    strategy: Bottleneck.prototype.strategy.LEAK,\n    penalty: null,\n    reservoir: null,\n    reservoirRefreshInterval: null,\n    reservoirRefreshAmount: null,\n    reservoirIncreaseInterval: null,\n    reservoirIncreaseAmount: null,\n    reservoirIncreaseMaximum: null\n  };\n  Bottleneck.prototype.localStoreDefaults = {\n    Promise: Promise,\n    timeout: null,\n    heartbeatInterval: 250\n  };\n  Bottleneck.prototype.redisStoreDefaults = {\n    Promise: Promise,\n    timeout: null,\n    heartbeatInterval: 5000,\n    clientTimeout: 10000,\n    Redis: null,\n    clientOptions: {},\n    clusterNodes: null,\n    clearDatastore: false,\n    connection: null\n  };\n  Bottleneck.prototype.instanceDefaults = {\n    datastore: \"local\",\n    connection: null,\n    id: \"<no-id>\",\n    rejectOnDrop: true,\n    trackDoneStatus: false,\n    Promise: Promise\n  };\n  Bottleneck.prototype.stopDefaults = {\n    enqueueErrorMessage: \"This limiter has been stopped and cannot accept new jobs.\",\n    dropWaitingJobs: true,\n    dropErrorMessage: \"This limiter has been stopped.\"\n  };\n  return Bottleneck;\n}.call(void 0);\n\nmodule.exports = Bottleneck;","\"use strict\";\n\nvar DLList;\nDLList = class DLList {\n  constructor(incr, decr) {\n    this.incr = incr;\n    this.decr = decr;\n    this._first = null;\n    this._last = null;\n    this.length = 0;\n  }\n\n  push(value) {\n    var node;\n    this.length++;\n\n    if (typeof this.incr === \"function\") {\n      this.incr();\n    }\n\n    node = {\n      value,\n      prev: this._last,\n      next: null\n    };\n\n    if (this._last != null) {\n      this._last.next = node;\n      this._last = node;\n    } else {\n      this._first = this._last = node;\n    }\n\n    return void 0;\n  }\n\n  shift() {\n    var value;\n\n    if (this._first == null) {\n      return;\n    } else {\n      this.length--;\n\n      if (typeof this.decr === \"function\") {\n        this.decr();\n      }\n    }\n\n    value = this._first.value;\n\n    if ((this._first = this._first.next) != null) {\n      this._first.prev = null;\n    } else {\n      this._last = null;\n    }\n\n    return value;\n  }\n\n  first() {\n    if (this._first != null) {\n      return this._first.value;\n    }\n  }\n\n  getArray() {\n    var node, ref, results;\n    node = this._first;\n    results = [];\n\n    while (node != null) {\n      results.push((ref = node, node = node.next, ref.value));\n    }\n\n    return results;\n  }\n\n  forEachShift(cb) {\n    var node;\n    node = this.shift();\n\n    while (node != null) {\n      cb(node), node = this.shift();\n    }\n\n    return void 0;\n  }\n\n  debug() {\n    var node, ref, ref1, ref2, results;\n    node = this._first;\n    results = [];\n\n    while (node != null) {\n      results.push((ref = node, node = node.next, {\n        value: ref.value,\n        prev: (ref1 = ref.prev) != null ? ref1.value : void 0,\n        next: (ref2 = ref.next) != null ? ref2.value : void 0\n      }));\n    }\n\n    return results;\n  }\n\n};\nmodule.exports = DLList;","import fetchOrthologs from './homology';\n\n// Enable references to fetchOrthologs when loaded via traditional script tag\nwindow.fetchOrthologs = fetchOrthologs;\n\n// Enable references to fetchOrthologs when imported as an ES6 module\nexport default fetchOrthologs;\n","import fetchOrthologsFromOma from './oma';\nimport {\n  fetchOrthologsFromOrthodb, fetchOrthologsFromOrthodbSparql\n} from './orthodb';\n\nasync function fetchOrthologs(genes, sourceOrg, targetOrgs, api='oma') {\n  if (api === 'oma') {\n    return await fetchOrthologsFromOma(genes, sourceOrg, targetOrgs);\n  } else if (api === 'orthodb') {\n    return await fetchOrthologsFromOrthodbSparql(genes, sourceOrg, targetOrgs);\n  }\n}\n\nexport default fetchOrthologs\n","/**\n * @fileoverview Client library for OMA (Orthology MAtrix)\n * API docs: https://omabrowser.org/api/docs\n *\n * This module supports fetching orthologs from OMA.  All functions here\n * support the single exported function `fetchOrthologsFromOma`.\n */\n\nimport {reportError} from './error';\n\nvar omaBase = 'https://omabrowser.org/api';\n\n/**\n  * Query Uniprot API for protein entry ID (e.g. P53_RAT) given gene and\n  * organism.  This output is needed as input for the OMA API.\n  */\nasync function fetchUniprotId(gene, org) {\n  var uniprotBase, columns, query, query, response, data, lines, columns,\n    i, genes, uniprotId;\n\n  // Selected headers:\n  //   - Entry, Entry name, Gene names\n  // Default headers (omit `columns` parameter):\n  //   - Entry, Entry name, Status, Protein names, Gene names, Organism, Length\n  columns = 'columns=id,entry name,genes';\n\n  // API docs: https://www.uniprot.org/help/api_queries\n  uniprotBase = (\n    'https://www.uniprot.org/uniprot/?format=tab&' + columns +\n    '&sort=score'\n  );\n\n  query = '&query=gene:' + gene + '+AND+organism:' + org;\n  response = await fetch(uniprotBase + query);\n  data = await response.text();\n  lines = data.split('\\n').slice(1, -1); // Omit headers, empty last line\n\n  for (i = 0; i < lines.length; i++) {\n    columns = lines[i].split('\\t');\n    genes = columns[2].split(' ').map(d => d.toLowerCase()); // e.g. tp53\n    uniprotId = columns[0]; // e.g. P53_RAT\n    // uniprotName = columns[1]; // e.g. P53_RAT\n\n    if (genes.includes(gene.toLowerCase())) return uniprotId;\n  }\n\n  throw Error(\n    'No Uniprot entry found for gene name \"' + gene + '\" ' +\n    'in organism \"' + org + '\"'\n  );\n}\n\n/**\n  * Query OMA API for orthology information on a protein \n  */\nasync function fetchOmaOrthologs(uniprotId) {\n  var omaUrl, response, data;\n  omaUrl = omaBase + '/protein/' + uniprotId + '/orthologs/';\n  response = await fetch(omaUrl);\n  data = await response.json();\n  if (response.status === 404) {\n    throw Error(\n      'OMA orthologs not found for Uniprot protein \"' + uniprotId + '\".'\n    );\n  }\n  return data;\n}\n\n/**\n  * Query OMA API for information on a protein\n  */\nasync function fetchOmaProtein(uniprotId) {\n  var omaUrl, response, data;\n  omaUrl = omaBase + '/protein/' + uniprotId + '/';\n  response = await fetch(omaUrl);\n  data = await response.json();\n  if (response.status === 404) {\n    throw Error(\n      'OMA protein not found for Uniprot protein \"' + uniprotId + '\".'\n    );\n  }\n  return data;\n}\n\n/**\n  * Convert organism scientific name to OMA ID prefix.\n  * Example: \"rattus-norvegicus -> \"RATNO\"\n  */\nfunction getOmaIdPrefix(org) {\n  // If this function proves inadequate, then refactor to use\n  // https://omabrowser.org/api/taxonomy/.  Fetch on page load, collapse\n  // tree, return leaf nodes as object with `name` as keys and `code` as\n  // values.\n  //\n  // As is, the implementation below seems adequate, simpler, and faster.\n  var prefix, genus, species;\n  if (org === 'homo sapiens') {\n    return 'HUMAN';\n  } else if (org === 'mus musculus') {\n    return 'MOUSE';\n  } else {\n    [genus, species] = org.split(' ');\n    prefix = genus.slice(0, 3) + species.slice(0, 2);\n    prefix = prefix.toUpperCase();\n    return prefix;\n  }\n}\n\n/**\n  * Given genes in a source organism, retrieve their orthologs in\n  * other organisms.  Returns OMA protein records for source and target\n  * organisms.\n  */\nasync function fetchOrthologsFromOma(genes, sourceOrg, targetOrgs) {\n  var proteinId, sourceProtein, rawOrthologs, omaId, omaIdPrefix,\n    theseOrthologs, error, targetOrgPrefixes, i, gene,\n    orthologs = [];\n\n  for (i = 0; i < genes.length; i++) {\n    gene = genes[i];\n    try {\n      proteinId = await fetchUniprotId(gene, sourceOrg);\n      sourceProtein = await fetchOmaProtein(proteinId);\n    } catch(error) {\n      reportError('geneNotFound', error, gene, sourceOrg, targetOrgs);\n    }\n    try {\n      rawOrthologs = await fetchOmaOrthologs(proteinId);\n    } catch(error) {\n      reportError('orthologsNotFound', error, gene, sourceOrg, targetOrgs);\n    }\n\n    // Get OMA ID prefixes for each target organism\n    targetOrgPrefixes = targetOrgs.map(org => getOmaIdPrefix(org));\n\n    theseOrthologs = rawOrthologs.filter(rawOrtholog => {\n      omaId = rawOrtholog.omaid; // e.g. RATNO03710\n      omaIdPrefix = omaId.slice(0, 5); // e.g. RATNO\n      return targetOrgPrefixes.includes(omaIdPrefix);\n    });\n\n    if (theseOrthologs.length === 0) {\n      reportError('orthologsNotFoundInTarget', error, gene, sourceOrg, targetOrgs);\n    }\n\n    theseOrthologs.unshift(sourceProtein); // prepend to array\n\n    theseOrthologs = theseOrthologs.map(d => {\n      return {\n        gene: d.canonicalid,\n        location: d.chromosome + ':' + d.locus.start + '-' + d.locus.end\n      }\n    });\n    orthologs.push(theseOrthologs);\n  }\n\n  return orthologs;\n}\n\nexport default fetchOrthologsFromOma;","\"use strict\";\n\nmodule.exports = require(\"./Bottleneck\");","\"use strict\";\n\nvar DLList, Events, Queues;\nDLList = require(\"./DLList\");\nEvents = require(\"./Events\");\nQueues = class Queues {\n  constructor(num_priorities) {\n    var i;\n    this.Events = new Events(this);\n    this._length = 0;\n\n    this._lists = function () {\n      var j, ref, results;\n      results = [];\n\n      for (i = j = 1, ref = num_priorities; 1 <= ref ? j <= ref : j >= ref; i = 1 <= ref ? ++j : --j) {\n        results.push(new DLList(() => {\n          return this.incr();\n        }, () => {\n          return this.decr();\n        }));\n      }\n\n      return results;\n    }.call(this);\n  }\n\n  incr() {\n    if (this._length++ === 0) {\n      return this.Events.trigger(\"leftzero\");\n    }\n  }\n\n  decr() {\n    if (--this._length === 0) {\n      return this.Events.trigger(\"zero\");\n    }\n  }\n\n  push(job) {\n    return this._lists[job.options.priority].push(job);\n  }\n\n  queued(priority) {\n    if (priority != null) {\n      return this._lists[priority].length;\n    } else {\n      return this._length;\n    }\n  }\n\n  shiftAll(fn) {\n    return this._lists.forEach(function (list) {\n      return list.forEachShift(fn);\n    });\n  }\n\n  getFirst(arr = this._lists) {\n    var j, len, list;\n\n    for (j = 0, len = arr.length; j < len; j++) {\n      list = arr[j];\n\n      if (list.length > 0) {\n        return list;\n      }\n    }\n\n    return [];\n  }\n\n  shiftLastFrom(priority) {\n    return this.getFirst(this._lists.slice(priority).reverse()).shift();\n  }\n\n};\nmodule.exports = Queues;","\"use strict\";\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\n\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\n\nvar BottleneckError, DEFAULT_PRIORITY, Job, NUM_PRIORITIES, parser;\nNUM_PRIORITIES = 10;\nDEFAULT_PRIORITY = 5;\nparser = require(\"./parser\");\nBottleneckError = require(\"./BottleneckError\");\nJob = class Job {\n  constructor(task, args, options, jobDefaults, rejectOnDrop, Events, _states, Promise) {\n    this.task = task;\n    this.args = args;\n    this.rejectOnDrop = rejectOnDrop;\n    this.Events = Events;\n    this._states = _states;\n    this.Promise = Promise;\n    this.options = parser.load(options, jobDefaults);\n    this.options.priority = this._sanitizePriority(this.options.priority);\n\n    if (this.options.id === jobDefaults.id) {\n      this.options.id = `${this.options.id}-${this._randomIndex()}`;\n    }\n\n    this.promise = new this.Promise((_resolve, _reject) => {\n      this._resolve = _resolve;\n      this._reject = _reject;\n    });\n    this.retryCount = 0;\n  }\n\n  _sanitizePriority(priority) {\n    var sProperty;\n    sProperty = ~~priority !== priority ? DEFAULT_PRIORITY : priority;\n\n    if (sProperty < 0) {\n      return 0;\n    } else if (sProperty > NUM_PRIORITIES - 1) {\n      return NUM_PRIORITIES - 1;\n    } else {\n      return sProperty;\n    }\n  }\n\n  _randomIndex() {\n    return Math.random().toString(36).slice(2);\n  }\n\n  doDrop({\n    error,\n    message = \"This job has been dropped by Bottleneck\"\n  } = {}) {\n    if (this._states.remove(this.options.id)) {\n      if (this.rejectOnDrop) {\n        this._reject(error != null ? error : new BottleneckError(message));\n      }\n\n      this.Events.trigger(\"dropped\", {\n        args: this.args,\n        options: this.options,\n        task: this.task,\n        promise: this.promise\n      });\n      return true;\n    } else {\n      return false;\n    }\n  }\n\n  _assertStatus(expected) {\n    var status;\n    status = this._states.jobStatus(this.options.id);\n\n    if (!(status === expected || expected === \"DONE\" && status === null)) {\n      throw new BottleneckError(`Invalid job status ${status}, expected ${expected}. Please open an issue at https://github.com/SGrondin/bottleneck/issues`);\n    }\n  }\n\n  doReceive() {\n    this._states.start(this.options.id);\n\n    return this.Events.trigger(\"received\", {\n      args: this.args,\n      options: this.options\n    });\n  }\n\n  doQueue(reachedHWM, blocked) {\n    this._assertStatus(\"RECEIVED\");\n\n    this._states.next(this.options.id);\n\n    return this.Events.trigger(\"queued\", {\n      args: this.args,\n      options: this.options,\n      reachedHWM,\n      blocked\n    });\n  }\n\n  doRun() {\n    if (this.retryCount === 0) {\n      this._assertStatus(\"QUEUED\");\n\n      this._states.next(this.options.id);\n    } else {\n      this._assertStatus(\"EXECUTING\");\n    }\n\n    return this.Events.trigger(\"scheduled\", {\n      args: this.args,\n      options: this.options\n    });\n  }\n\n  doExecute(chained, clearGlobalState, run, free) {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      var error, eventInfo, passed;\n\n      if (_this.retryCount === 0) {\n        _this._assertStatus(\"RUNNING\");\n\n        _this._states.next(_this.options.id);\n      } else {\n        _this._assertStatus(\"EXECUTING\");\n      }\n\n      eventInfo = {\n        args: _this.args,\n        options: _this.options,\n        retryCount: _this.retryCount\n      };\n\n      _this.Events.trigger(\"executing\", eventInfo);\n\n      try {\n        passed = yield chained != null ? chained.schedule(_this.options, _this.task, ..._this.args) : _this.task(..._this.args);\n\n        if (clearGlobalState()) {\n          _this.doDone(eventInfo);\n\n          yield free(_this.options, eventInfo);\n\n          _this._assertStatus(\"DONE\");\n\n          return _this._resolve(passed);\n        }\n      } catch (error1) {\n        error = error1;\n        return _this._onFailure(error, eventInfo, clearGlobalState, run, free);\n      }\n    })();\n  }\n\n  doExpire(clearGlobalState, run, free) {\n    var error, eventInfo;\n\n    if (this._states.jobStatus(this.options.id === \"RUNNING\")) {\n      this._states.next(this.options.id);\n    }\n\n    this._assertStatus(\"EXECUTING\");\n\n    eventInfo = {\n      args: this.args,\n      options: this.options,\n      retryCount: this.retryCount\n    };\n    error = new BottleneckError(`This job timed out after ${this.options.expiration} ms.`);\n    return this._onFailure(error, eventInfo, clearGlobalState, run, free);\n  }\n\n  _onFailure(error, eventInfo, clearGlobalState, run, free) {\n    var _this2 = this;\n\n    return _asyncToGenerator(function* () {\n      var retry, retryAfter;\n\n      if (clearGlobalState()) {\n        retry = yield _this2.Events.trigger(\"failed\", error, eventInfo);\n\n        if (retry != null) {\n          retryAfter = ~~retry;\n\n          _this2.Events.trigger(\"retry\", `Retrying ${_this2.options.id} after ${retryAfter} ms`, eventInfo);\n\n          _this2.retryCount++;\n          return run(retryAfter);\n        } else {\n          _this2.doDone(eventInfo);\n\n          yield free(_this2.options, eventInfo);\n\n          _this2._assertStatus(\"DONE\");\n\n          return _this2._reject(error);\n        }\n      }\n    })();\n  }\n\n  doDone(eventInfo) {\n    this._assertStatus(\"EXECUTING\");\n\n    this._states.next(this.options.id);\n\n    return this.Events.trigger(\"done\", eventInfo);\n  }\n\n};\nmodule.exports = Job;","\"use strict\";\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\n\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\n\nvar BottleneckError, LocalDatastore, parser;\nparser = require(\"./parser\");\nBottleneckError = require(\"./BottleneckError\");\nLocalDatastore = class LocalDatastore {\n  constructor(instance, storeOptions, storeInstanceOptions) {\n    this.instance = instance;\n    this.storeOptions = storeOptions;\n    this.clientId = this.instance._randomIndex();\n    parser.load(storeInstanceOptions, storeInstanceOptions, this);\n    this._nextRequest = this._lastReservoirRefresh = this._lastReservoirIncrease = Date.now();\n    this._running = 0;\n    this._done = 0;\n    this._unblockTime = 0;\n    this.ready = this.Promise.resolve();\n    this.clients = {};\n\n    this._startHeartbeat();\n  }\n\n  _startHeartbeat() {\n    var base;\n\n    if (this.heartbeat == null && (this.storeOptions.reservoirRefreshInterval != null && this.storeOptions.reservoirRefreshAmount != null || this.storeOptions.reservoirIncreaseInterval != null && this.storeOptions.reservoirIncreaseAmount != null)) {\n      return typeof (base = this.heartbeat = setInterval(() => {\n        var amount, incr, maximum, now, reservoir;\n        now = Date.now();\n\n        if (this.storeOptions.reservoirRefreshInterval != null && now >= this._lastReservoirRefresh + this.storeOptions.reservoirRefreshInterval) {\n          this._lastReservoirRefresh = now;\n          this.storeOptions.reservoir = this.storeOptions.reservoirRefreshAmount;\n\n          this.instance._drainAll(this.computeCapacity());\n        }\n\n        if (this.storeOptions.reservoirIncreaseInterval != null && now >= this._lastReservoirIncrease + this.storeOptions.reservoirIncreaseInterval) {\n          var _this$storeOptions = this.storeOptions;\n          amount = _this$storeOptions.reservoirIncreaseAmount;\n          maximum = _this$storeOptions.reservoirIncreaseMaximum;\n          reservoir = _this$storeOptions.reservoir;\n          this._lastReservoirIncrease = now;\n          incr = maximum != null ? Math.min(amount, maximum - reservoir) : amount;\n\n          if (incr > 0) {\n            this.storeOptions.reservoir += incr;\n            return this.instance._drainAll(this.computeCapacity());\n          }\n        }\n      }, this.heartbeatInterval)).unref === \"function\" ? base.unref() : void 0;\n    } else {\n      return clearInterval(this.heartbeat);\n    }\n  }\n\n  __publish__(message) {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      yield _this.yieldLoop();\n      return _this.instance.Events.trigger(\"message\", message.toString());\n    })();\n  }\n\n  __disconnect__(flush) {\n    var _this2 = this;\n\n    return _asyncToGenerator(function* () {\n      yield _this2.yieldLoop();\n      clearInterval(_this2.heartbeat);\n      return _this2.Promise.resolve();\n    })();\n  }\n\n  yieldLoop(t = 0) {\n    return new this.Promise(function (resolve, reject) {\n      return setTimeout(resolve, t);\n    });\n  }\n\n  computePenalty() {\n    var ref;\n    return (ref = this.storeOptions.penalty) != null ? ref : 15 * this.storeOptions.minTime || 5000;\n  }\n\n  __updateSettings__(options) {\n    var _this3 = this;\n\n    return _asyncToGenerator(function* () {\n      yield _this3.yieldLoop();\n      parser.overwrite(options, options, _this3.storeOptions);\n\n      _this3._startHeartbeat();\n\n      _this3.instance._drainAll(_this3.computeCapacity());\n\n      return true;\n    })();\n  }\n\n  __running__() {\n    var _this4 = this;\n\n    return _asyncToGenerator(function* () {\n      yield _this4.yieldLoop();\n      return _this4._running;\n    })();\n  }\n\n  __queued__() {\n    var _this5 = this;\n\n    return _asyncToGenerator(function* () {\n      yield _this5.yieldLoop();\n      return _this5.instance.queued();\n    })();\n  }\n\n  __done__() {\n    var _this6 = this;\n\n    return _asyncToGenerator(function* () {\n      yield _this6.yieldLoop();\n      return _this6._done;\n    })();\n  }\n\n  __groupCheck__(time) {\n    var _this7 = this;\n\n    return _asyncToGenerator(function* () {\n      yield _this7.yieldLoop();\n      return _this7._nextRequest + _this7.timeout < time;\n    })();\n  }\n\n  computeCapacity() {\n    var maxConcurrent, reservoir;\n    var _this$storeOptions2 = this.storeOptions;\n    maxConcurrent = _this$storeOptions2.maxConcurrent;\n    reservoir = _this$storeOptions2.reservoir;\n\n    if (maxConcurrent != null && reservoir != null) {\n      return Math.min(maxConcurrent - this._running, reservoir);\n    } else if (maxConcurrent != null) {\n      return maxConcurrent - this._running;\n    } else if (reservoir != null) {\n      return reservoir;\n    } else {\n      return null;\n    }\n  }\n\n  conditionsCheck(weight) {\n    var capacity;\n    capacity = this.computeCapacity();\n    return capacity == null || weight <= capacity;\n  }\n\n  __incrementReservoir__(incr) {\n    var _this8 = this;\n\n    return _asyncToGenerator(function* () {\n      var reservoir;\n      yield _this8.yieldLoop();\n      reservoir = _this8.storeOptions.reservoir += incr;\n\n      _this8.instance._drainAll(_this8.computeCapacity());\n\n      return reservoir;\n    })();\n  }\n\n  __currentReservoir__() {\n    var _this9 = this;\n\n    return _asyncToGenerator(function* () {\n      yield _this9.yieldLoop();\n      return _this9.storeOptions.reservoir;\n    })();\n  }\n\n  isBlocked(now) {\n    return this._unblockTime >= now;\n  }\n\n  check(weight, now) {\n    return this.conditionsCheck(weight) && this._nextRequest - now <= 0;\n  }\n\n  __check__(weight) {\n    var _this10 = this;\n\n    return _asyncToGenerator(function* () {\n      var now;\n      yield _this10.yieldLoop();\n      now = Date.now();\n      return _this10.check(weight, now);\n    })();\n  }\n\n  __register__(index, weight, expiration) {\n    var _this11 = this;\n\n    return _asyncToGenerator(function* () {\n      var now, wait;\n      yield _this11.yieldLoop();\n      now = Date.now();\n\n      if (_this11.conditionsCheck(weight)) {\n        _this11._running += weight;\n\n        if (_this11.storeOptions.reservoir != null) {\n          _this11.storeOptions.reservoir -= weight;\n        }\n\n        wait = Math.max(_this11._nextRequest - now, 0);\n        _this11._nextRequest = now + wait + _this11.storeOptions.minTime;\n        return {\n          success: true,\n          wait,\n          reservoir: _this11.storeOptions.reservoir\n        };\n      } else {\n        return {\n          success: false\n        };\n      }\n    })();\n  }\n\n  strategyIsBlock() {\n    return this.storeOptions.strategy === 3;\n  }\n\n  __submit__(queueLength, weight) {\n    var _this12 = this;\n\n    return _asyncToGenerator(function* () {\n      var blocked, now, reachedHWM;\n      yield _this12.yieldLoop();\n\n      if (_this12.storeOptions.maxConcurrent != null && weight > _this12.storeOptions.maxConcurrent) {\n        throw new BottleneckError(`Impossible to add a job having a weight of ${weight} to a limiter having a maxConcurrent setting of ${_this12.storeOptions.maxConcurrent}`);\n      }\n\n      now = Date.now();\n      reachedHWM = _this12.storeOptions.highWater != null && queueLength === _this12.storeOptions.highWater && !_this12.check(weight, now);\n      blocked = _this12.strategyIsBlock() && (reachedHWM || _this12.isBlocked(now));\n\n      if (blocked) {\n        _this12._unblockTime = now + _this12.computePenalty();\n        _this12._nextRequest = _this12._unblockTime + _this12.storeOptions.minTime;\n\n        _this12.instance._dropAllQueued();\n      }\n\n      return {\n        reachedHWM,\n        blocked,\n        strategy: _this12.storeOptions.strategy\n      };\n    })();\n  }\n\n  __free__(index, weight) {\n    var _this13 = this;\n\n    return _asyncToGenerator(function* () {\n      yield _this13.yieldLoop();\n      _this13._running -= weight;\n      _this13._done += weight;\n\n      _this13.instance._drainAll(_this13.computeCapacity());\n\n      return {\n        running: _this13._running\n      };\n    })();\n  }\n\n};\nmodule.exports = LocalDatastore;","\"use strict\";\n\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _nonIterableRest(); }\n\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); }\n\nfunction _iterableToArrayLimit(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\n\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\n\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\n\nvar BottleneckError, IORedisConnection, RedisConnection, RedisDatastore, parser;\nparser = require(\"./parser\");\nBottleneckError = require(\"./BottleneckError\");\nRedisConnection = require(\"./RedisConnection\");\nIORedisConnection = require(\"./IORedisConnection\");\nRedisDatastore = class RedisDatastore {\n  constructor(instance, storeOptions, storeInstanceOptions) {\n    this.instance = instance;\n    this.storeOptions = storeOptions;\n    this.originalId = this.instance.id;\n    this.clientId = this.instance._randomIndex();\n    parser.load(storeInstanceOptions, storeInstanceOptions, this);\n    this.clients = {};\n    this.capacityPriorityCounters = {};\n    this.sharedConnection = this.connection != null;\n\n    if (this.connection == null) {\n      this.connection = this.instance.datastore === \"redis\" ? new RedisConnection({\n        Redis: this.Redis,\n        clientOptions: this.clientOptions,\n        Promise: this.Promise,\n        Events: this.instance.Events\n      }) : this.instance.datastore === \"ioredis\" ? new IORedisConnection({\n        Redis: this.Redis,\n        clientOptions: this.clientOptions,\n        clusterNodes: this.clusterNodes,\n        Promise: this.Promise,\n        Events: this.instance.Events\n      }) : void 0;\n    }\n\n    this.instance.connection = this.connection;\n    this.instance.datastore = this.connection.datastore;\n    this.ready = this.connection.ready.then(clients => {\n      this.clients = clients;\n      return this.runScript(\"init\", this.prepareInitSettings(this.clearDatastore));\n    }).then(() => {\n      return this.connection.__addLimiter__(this.instance);\n    }).then(() => {\n      return this.runScript(\"register_client\", [this.instance.queued()]);\n    }).then(() => {\n      var base;\n\n      if (typeof (base = this.heartbeat = setInterval(() => {\n        return this.runScript(\"heartbeat\", []).catch(e => {\n          return this.instance.Events.trigger(\"error\", e);\n        });\n      }, this.heartbeatInterval)).unref === \"function\") {\n        base.unref();\n      }\n\n      return this.clients;\n    });\n  }\n\n  __publish__(message) {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      var client;\n\n      var _ref = yield _this.ready;\n\n      client = _ref.client;\n      return client.publish(_this.instance.channel(), `message:${message.toString()}`);\n    })();\n  }\n\n  onMessage(channel, message) {\n    var _this2 = this;\n\n    return _asyncToGenerator(function* () {\n      var capacity, counter, data, drained, e, newCapacity, pos, priorityClient, rawCapacity, type;\n\n      try {\n        pos = message.indexOf(\":\");\n        var _ref2 = [message.slice(0, pos), message.slice(pos + 1)];\n        type = _ref2[0];\n        data = _ref2[1];\n\n        if (type === \"capacity\") {\n          return yield _this2.instance._drainAll(data.length > 0 ? ~~data : void 0);\n        } else if (type === \"capacity-priority\") {\n          var _data$split = data.split(\":\");\n\n          var _data$split2 = _slicedToArray(_data$split, 3);\n\n          rawCapacity = _data$split2[0];\n          priorityClient = _data$split2[1];\n          counter = _data$split2[2];\n          capacity = rawCapacity.length > 0 ? ~~rawCapacity : void 0;\n\n          if (priorityClient === _this2.clientId) {\n            drained = yield _this2.instance._drainAll(capacity);\n            newCapacity = capacity != null ? capacity - (drained || 0) : \"\";\n            return yield _this2.clients.client.publish(_this2.instance.channel(), `capacity-priority:${newCapacity}::${counter}`);\n          } else if (priorityClient === \"\") {\n            clearTimeout(_this2.capacityPriorityCounters[counter]);\n            delete _this2.capacityPriorityCounters[counter];\n            return _this2.instance._drainAll(capacity);\n          } else {\n            return _this2.capacityPriorityCounters[counter] = setTimeout(\n            /*#__PURE__*/\n            _asyncToGenerator(function* () {\n              var e;\n\n              try {\n                delete _this2.capacityPriorityCounters[counter];\n                yield _this2.runScript(\"blacklist_client\", [priorityClient]);\n                return yield _this2.instance._drainAll(capacity);\n              } catch (error) {\n                e = error;\n                return _this2.instance.Events.trigger(\"error\", e);\n              }\n            }), 1000);\n          }\n        } else if (type === \"message\") {\n          return _this2.instance.Events.trigger(\"message\", data);\n        } else if (type === \"blocked\") {\n          return yield _this2.instance._dropAllQueued();\n        }\n      } catch (error) {\n        e = error;\n        return _this2.instance.Events.trigger(\"error\", e);\n      }\n    })();\n  }\n\n  __disconnect__(flush) {\n    clearInterval(this.heartbeat);\n\n    if (this.sharedConnection) {\n      return this.connection.__removeLimiter__(this.instance);\n    } else {\n      return this.connection.disconnect(flush);\n    }\n  }\n\n  runScript(name, args) {\n    var _this3 = this;\n\n    return _asyncToGenerator(function* () {\n      if (!(name === \"init\" || name === \"register_client\")) {\n        yield _this3.ready;\n      }\n\n      return new _this3.Promise((resolve, reject) => {\n        var all_args, arr;\n        all_args = [Date.now(), _this3.clientId].concat(args);\n\n        _this3.instance.Events.trigger(\"debug\", `Calling Redis script: ${name}.lua`, all_args);\n\n        arr = _this3.connection.__scriptArgs__(name, _this3.originalId, all_args, function (err, replies) {\n          if (err != null) {\n            return reject(err);\n          }\n\n          return resolve(replies);\n        });\n        return _this3.connection.__scriptFn__(name)(...arr);\n      }).catch(e => {\n        if (e.message === \"SETTINGS_KEY_NOT_FOUND\") {\n          if (name === \"heartbeat\") {\n            return _this3.Promise.resolve();\n          } else {\n            return _this3.runScript(\"init\", _this3.prepareInitSettings(false)).then(() => {\n              return _this3.runScript(name, args);\n            });\n          }\n        } else if (e.message === \"UNKNOWN_CLIENT\") {\n          return _this3.runScript(\"register_client\", [_this3.instance.queued()]).then(() => {\n            return _this3.runScript(name, args);\n          });\n        } else {\n          return _this3.Promise.reject(e);\n        }\n      });\n    })();\n  }\n\n  prepareArray(arr) {\n    var i, len, results, x;\n    results = [];\n\n    for (i = 0, len = arr.length; i < len; i++) {\n      x = arr[i];\n      results.push(x != null ? x.toString() : \"\");\n    }\n\n    return results;\n  }\n\n  prepareObject(obj) {\n    var arr, k, v;\n    arr = [];\n\n    for (k in obj) {\n      v = obj[k];\n      arr.push(k, v != null ? v.toString() : \"\");\n    }\n\n    return arr;\n  }\n\n  prepareInitSettings(clear) {\n    var args;\n    args = this.prepareObject(Object.assign({}, this.storeOptions, {\n      id: this.originalId,\n      version: this.instance.version,\n      groupTimeout: this.timeout,\n      clientTimeout: this.clientTimeout\n    }));\n    args.unshift(clear ? 1 : 0, this.instance.version);\n    return args;\n  }\n\n  convertBool(b) {\n    return !!b;\n  }\n\n  __updateSettings__(options) {\n    var _this4 = this;\n\n    return _asyncToGenerator(function* () {\n      yield _this4.runScript(\"update_settings\", _this4.prepareObject(options));\n      return parser.overwrite(options, options, _this4.storeOptions);\n    })();\n  }\n\n  __running__() {\n    return this.runScript(\"running\", []);\n  }\n\n  __queued__() {\n    return this.runScript(\"queued\", []);\n  }\n\n  __done__() {\n    return this.runScript(\"done\", []);\n  }\n\n  __groupCheck__() {\n    var _this5 = this;\n\n    return _asyncToGenerator(function* () {\n      return _this5.convertBool((yield _this5.runScript(\"group_check\", [])));\n    })();\n  }\n\n  __incrementReservoir__(incr) {\n    return this.runScript(\"increment_reservoir\", [incr]);\n  }\n\n  __currentReservoir__() {\n    return this.runScript(\"current_reservoir\", []);\n  }\n\n  __check__(weight) {\n    var _this6 = this;\n\n    return _asyncToGenerator(function* () {\n      return _this6.convertBool((yield _this6.runScript(\"check\", _this6.prepareArray([weight]))));\n    })();\n  }\n\n  __register__(index, weight, expiration) {\n    var _this7 = this;\n\n    return _asyncToGenerator(function* () {\n      var reservoir, success, wait;\n\n      var _ref4 = yield _this7.runScript(\"register\", _this7.prepareArray([index, weight, expiration]));\n\n      var _ref5 = _slicedToArray(_ref4, 3);\n\n      success = _ref5[0];\n      wait = _ref5[1];\n      reservoir = _ref5[2];\n      return {\n        success: _this7.convertBool(success),\n        wait,\n        reservoir\n      };\n    })();\n  }\n\n  __submit__(queueLength, weight) {\n    var _this8 = this;\n\n    return _asyncToGenerator(function* () {\n      var blocked, e, maxConcurrent, overweight, reachedHWM, strategy;\n\n      try {\n        var _ref6 = yield _this8.runScript(\"submit\", _this8.prepareArray([queueLength, weight]));\n\n        var _ref7 = _slicedToArray(_ref6, 3);\n\n        reachedHWM = _ref7[0];\n        blocked = _ref7[1];\n        strategy = _ref7[2];\n        return {\n          reachedHWM: _this8.convertBool(reachedHWM),\n          blocked: _this8.convertBool(blocked),\n          strategy\n        };\n      } catch (error) {\n        e = error;\n\n        if (e.message.indexOf(\"OVERWEIGHT\") === 0) {\n          var _e$message$split = e.message.split(\":\");\n\n          var _e$message$split2 = _slicedToArray(_e$message$split, 3);\n\n          overweight = _e$message$split2[0];\n          weight = _e$message$split2[1];\n          maxConcurrent = _e$message$split2[2];\n          throw new BottleneckError(`Impossible to add a job having a weight of ${weight} to a limiter having a maxConcurrent setting of ${maxConcurrent}`);\n        } else {\n          throw e;\n        }\n      }\n    })();\n  }\n\n  __free__(index, weight) {\n    var _this9 = this;\n\n    return _asyncToGenerator(function* () {\n      var running;\n      running = yield _this9.runScript(\"free\", _this9.prepareArray([index]));\n      return {\n        running\n      };\n    })();\n  }\n\n};\nmodule.exports = RedisDatastore;","\"use strict\";\n\nvar BottleneckError, States;\nBottleneckError = require(\"./BottleneckError\");\nStates = class States {\n  constructor(status1) {\n    this.status = status1;\n    this._jobs = {};\n    this.counts = this.status.map(function () {\n      return 0;\n    });\n  }\n\n  next(id) {\n    var current, next;\n    current = this._jobs[id];\n    next = current + 1;\n\n    if (current != null && next < this.status.length) {\n      this.counts[current]--;\n      this.counts[next]++;\n      return this._jobs[id]++;\n    } else if (current != null) {\n      this.counts[current]--;\n      return delete this._jobs[id];\n    }\n  }\n\n  start(id) {\n    var initial;\n    initial = 0;\n    this._jobs[id] = initial;\n    return this.counts[initial]++;\n  }\n\n  remove(id) {\n    var current;\n    current = this._jobs[id];\n\n    if (current != null) {\n      this.counts[current]--;\n      delete this._jobs[id];\n    }\n\n    return current != null;\n  }\n\n  jobStatus(id) {\n    var ref;\n    return (ref = this.status[this._jobs[id]]) != null ? ref : null;\n  }\n\n  statusJobs(status) {\n    var k, pos, ref, results, v;\n\n    if (status != null) {\n      pos = this.status.indexOf(status);\n\n      if (pos < 0) {\n        throw new BottleneckError(`status must be one of ${this.status.join(', ')}`);\n      }\n\n      ref = this._jobs;\n      results = [];\n\n      for (k in ref) {\n        v = ref[k];\n\n        if (v === pos) {\n          results.push(k);\n        }\n      }\n\n      return results;\n    } else {\n      return Object.keys(this._jobs);\n    }\n  }\n\n  statusCounts() {\n    return this.counts.reduce((acc, v, i) => {\n      acc[this.status[i]] = v;\n      return acc;\n    }, {});\n  }\n\n};\nmodule.exports = States;","\"use strict\";\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\n\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\n\nvar DLList, Sync;\nDLList = require(\"./DLList\");\nSync = class Sync {\n  constructor(name, Promise) {\n    this.schedule = this.schedule.bind(this);\n    this.name = name;\n    this.Promise = Promise;\n    this._running = 0;\n    this._queue = new DLList();\n  }\n\n  isEmpty() {\n    return this._queue.length === 0;\n  }\n\n  _tryToRun() {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      var args, cb, error, reject, resolve, returned, task;\n\n      if (_this._running < 1 && _this._queue.length > 0) {\n        _this._running++;\n\n        var _this$_queue$shift = _this._queue.shift();\n\n        task = _this$_queue$shift.task;\n        args = _this$_queue$shift.args;\n        resolve = _this$_queue$shift.resolve;\n        reject = _this$_queue$shift.reject;\n        cb = yield _asyncToGenerator(function* () {\n          try {\n            returned = yield task(...args);\n            return function () {\n              return resolve(returned);\n            };\n          } catch (error1) {\n            error = error1;\n            return function () {\n              return reject(error);\n            };\n          }\n        })();\n        _this._running--;\n\n        _this._tryToRun();\n\n        return cb();\n      }\n    })();\n  }\n\n  schedule(task, ...args) {\n    var promise, reject, resolve;\n    resolve = reject = null;\n    promise = new this.Promise(function (_resolve, _reject) {\n      resolve = _resolve;\n      return reject = _reject;\n    });\n\n    this._queue.push({\n      task,\n      args,\n      resolve,\n      reject\n    });\n\n    this._tryToRun();\n\n    return promise;\n  }\n\n};\nmodule.exports = Sync;","\"use strict\";\n\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _nonIterableRest(); }\n\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); }\n\nfunction _iterableToArrayLimit(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\n\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\n\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\n\nvar Events, Group, IORedisConnection, RedisConnection, Scripts, parser;\nparser = require(\"./parser\");\nEvents = require(\"./Events\");\nRedisConnection = require(\"./RedisConnection\");\nIORedisConnection = require(\"./IORedisConnection\");\nScripts = require(\"./Scripts\");\n\nGroup = function () {\n  class Group {\n    constructor(limiterOptions = {}) {\n      this.deleteKey = this.deleteKey.bind(this);\n      this.limiterOptions = limiterOptions;\n      parser.load(this.limiterOptions, this.defaults, this);\n      this.Events = new Events(this);\n      this.instances = {};\n      this.Bottleneck = require(\"./Bottleneck\");\n\n      this._startAutoCleanup();\n\n      this.sharedConnection = this.connection != null;\n\n      if (this.connection == null) {\n        if (this.limiterOptions.datastore === \"redis\") {\n          this.connection = new RedisConnection(Object.assign({}, this.limiterOptions, {\n            Events: this.Events\n          }));\n        } else if (this.limiterOptions.datastore === \"ioredis\") {\n          this.connection = new IORedisConnection(Object.assign({}, this.limiterOptions, {\n            Events: this.Events\n          }));\n        }\n      }\n    }\n\n    key(key = \"\") {\n      var ref;\n      return (ref = this.instances[key]) != null ? ref : (() => {\n        var limiter;\n        limiter = this.instances[key] = new this.Bottleneck(Object.assign(this.limiterOptions, {\n          id: `${this.id}-${key}`,\n          timeout: this.timeout,\n          connection: this.connection\n        }));\n        this.Events.trigger(\"created\", limiter, key);\n        return limiter;\n      })();\n    }\n\n    deleteKey(key = \"\") {\n      var _this = this;\n\n      return _asyncToGenerator(function* () {\n        var deleted, instance;\n        instance = _this.instances[key];\n\n        if (_this.connection) {\n          deleted = yield _this.connection.__runCommand__(['del', ...Scripts.allKeys(`${_this.id}-${key}`)]);\n        }\n\n        if (instance != null) {\n          delete _this.instances[key];\n          yield instance.disconnect();\n        }\n\n        return instance != null || deleted > 0;\n      })();\n    }\n\n    limiters() {\n      var k, ref, results, v;\n      ref = this.instances;\n      results = [];\n\n      for (k in ref) {\n        v = ref[k];\n        results.push({\n          key: k,\n          limiter: v\n        });\n      }\n\n      return results;\n    }\n\n    keys() {\n      return Object.keys(this.instances);\n    }\n\n    clusterKeys() {\n      var _this2 = this;\n\n      return _asyncToGenerator(function* () {\n        var cursor, end, found, i, k, keys, len, next, start;\n\n        if (_this2.connection == null) {\n          return _this2.Promise.resolve(_this2.keys());\n        }\n\n        keys = [];\n        cursor = null;\n        start = `b_${_this2.id}-`.length;\n        end = \"_settings\".length;\n\n        while (cursor !== 0) {\n          var _ref = yield _this2.connection.__runCommand__([\"scan\", cursor != null ? cursor : 0, \"match\", `b_${_this2.id}-*_settings`, \"count\", 10000]);\n\n          var _ref2 = _slicedToArray(_ref, 2);\n\n          next = _ref2[0];\n          found = _ref2[1];\n          cursor = ~~next;\n\n          for (i = 0, len = found.length; i < len; i++) {\n            k = found[i];\n            keys.push(k.slice(start, -end));\n          }\n        }\n\n        return keys;\n      })();\n    }\n\n    _startAutoCleanup() {\n      var _this3 = this;\n\n      var base;\n      clearInterval(this.interval);\n      return typeof (base = this.interval = setInterval(\n      /*#__PURE__*/\n      _asyncToGenerator(function* () {\n        var e, k, ref, results, time, v;\n        time = Date.now();\n        ref = _this3.instances;\n        results = [];\n\n        for (k in ref) {\n          v = ref[k];\n\n          try {\n            if (yield v._store.__groupCheck__(time)) {\n              results.push(_this3.deleteKey(k));\n            } else {\n              results.push(void 0);\n            }\n          } catch (error) {\n            e = error;\n            results.push(v.Events.trigger(\"error\", e));\n          }\n        }\n\n        return results;\n      }), this.timeout / 2)).unref === \"function\" ? base.unref() : void 0;\n    }\n\n    updateSettings(options = {}) {\n      parser.overwrite(options, this.defaults, this);\n      parser.overwrite(options, options, this.limiterOptions);\n\n      if (options.timeout != null) {\n        return this._startAutoCleanup();\n      }\n    }\n\n    disconnect(flush = true) {\n      var ref;\n\n      if (!this.sharedConnection) {\n        return (ref = this.connection) != null ? ref.disconnect(flush) : void 0;\n      }\n    }\n\n  }\n\n  ;\n  Group.prototype.defaults = {\n    timeout: 1000 * 60 * 5,\n    connection: null,\n    Promise: Promise,\n    id: \"group-key\"\n  };\n  return Group;\n}.call(void 0);\n\nmodule.exports = Group;","\"use strict\";\n\nvar Batcher, Events, parser;\nparser = require(\"./parser\");\nEvents = require(\"./Events\");\n\nBatcher = function () {\n  class Batcher {\n    constructor(options = {}) {\n      this.options = options;\n      parser.load(this.options, this.defaults, this);\n      this.Events = new Events(this);\n      this._arr = [];\n\n      this._resetPromise();\n\n      this._lastFlush = Date.now();\n    }\n\n    _resetPromise() {\n      return this._promise = new this.Promise((res, rej) => {\n        return this._resolve = res;\n      });\n    }\n\n    _flush() {\n      clearTimeout(this._timeout);\n      this._lastFlush = Date.now();\n\n      this._resolve();\n\n      this.Events.trigger(\"batch\", this._arr);\n      this._arr = [];\n      return this._resetPromise();\n    }\n\n    add(data) {\n      var ret;\n\n      this._arr.push(data);\n\n      ret = this._promise;\n\n      if (this._arr.length === this.maxSize) {\n        this._flush();\n      } else if (this.maxTime != null && this._arr.length === 1) {\n        this._timeout = setTimeout(() => {\n          return this._flush();\n        }, this.maxTime);\n      }\n\n      return ret;\n    }\n\n  }\n\n  ;\n  Batcher.prototype.defaults = {\n    maxTime: null,\n    maxSize: null,\n    Promise: Promise\n  };\n  return Batcher;\n}.call(void 0);\n\nmodule.exports = Batcher;","const taxidByName = {\n  'aedes aegypti': '7159',\n  'anopheles gambiae': '7165',\n  'arabidopsis thaliana': '3702',\n  'aspergillis fumigatus': '746128',\n  'aspergillus niger': '5061',\n  'aspergillus oryzae': '5062',\n  'bos taurus': '9913',\n  'brachypodium distachyon': '15368',\n  'caenorhabditis elegans': '6239',\n  'callithrix jacchus': '9483',\n  'canis lupus familiaris': '9615',\n  'chlorocebus sabaeus': '60711',\n  'ciona intestinalis': '7719',\n  'capsicum annuum': '4072',\n  'culex quinquefasciatus': '7176',\n  'danio rerio': '7955',\n  'drosophila melanogaster': '7227',\n  'equus caballus': '9796',\n  'felis catus': '9685',\n  'gallus gallus': '9031',\n  'glycine max': '3847',\n  'gorilla gorilla': '9593',\n  'homo sapiens': '9606',\n  'hordeum vulgare': '4513',\n  'macaca fascicularis': '9541',\n  'macaca mulatta': '9544',\n  'mus musculus': '10090',\n  'musa acuminata': '4641',\n  'oryza sativa': '4530',\n  'ornithorhynchus anatinus': '9258',\n  'pan paniscus': '9597',\n  'pan troglodytes': '9598',\n  'plasmodium falciparum': '5833',\n  'rattus norvegicus': '10116',\n  'saccharomyces cerevisiae': '4932',\n  'solanum lycopersicum': '4081',\n  'sus scrofa': '9823',\n  'vitis vinifera': '29760',\n  'zea mays': '4577'\n}\nexport default taxidByName;\n","import {fetchOrthoDBJson} from './orthodb'\n\n/**\n * Queries MyGene.info API, returns parsed JSON\n *\n * Docs:\n * https://docs.mygene.info/en/v3/\n *\n * Example:\n * https://mygene.info/v3/query?q=symbol:cdk2%20OR%20symbol:brca1&species=9606&fields=symbol,genomic_pos,name\n */\n async function fetchMyGeneInfo(queryString) {\n  const myGeneBase = 'https://mygene.info/v3/query';\n  const response = await fetch(myGeneBase + queryString + '&size=20');\n  const data = await response.json();\n  return data;\n}\n\n/**\n * Transforms MyGene.info (MGI) gene into Ideogram annotation\n */\n function parseAnnotFromMgiGene(gene) {\n\n  console.log('in parseAnnotFromMgiGene, gene:', gene)\n  // Filters out placements on alternative loci scaffolds, an advanced\n  // genome assembly feature we are not concerned with in ideograms.\n  //\n  // Example:\n  // https://mygene.info/v3/query?q=symbol:PTPRC&species=9606&fields=symbol,genomic_pos,name\n  let genomicPos = null;\n  if (Array.isArray(gene.genomic_pos)) {\n    genomicPos = gene.genomic_pos.filter(pos => !pos.chr.includes('_'))[0];\n  } else {\n    genomicPos = gene.genomic_pos;\n  }\n\n  const annot = {\n    name: gene.symbol,\n    chr: genomicPos.chr,\n    start: genomicPos.start,\n    stop: genomicPos.end,\n    id: genomicPos.ensemblgene\n  };\n\n  annot.location = annot.chr + ':' + annot.start + '-' + annot.stop\n\n  return annot;\n}\n\nfunction getMyGeneInfoQueryString(genes, taxid) {\n  const qParam = genes.map(gene => {\n    if (gene.ensemblId) {\n      return `ensemblgene:${gene.ensemblId}`\n    } else {\n    // Escape genes, so e.g. the fly gene Su(H) becomes Su\\(H\\).\n    // https://mygene.info/v3/query?q=symbol:Su\\(H\\)&species=7227&fields=symbol,genomic_pos,name&size=20\n    // See https://github.com/biothings/mygene.info/issues/112.\n    if (gene.name) gene = gene.name\n    const escapedGene = gene.replaceAll('(', '\\\\(').replaceAll(')', '\\\\)')\n    return `symbol:${escapedGene}`;\n    }\n  }).join(' OR ');\n\n  // Example:\n  // https://mygene.info/v3/query?q=symbol:BRCA1&species=9606&fields=symbol,genomic_pos,name\n  return `?q=${qParam}&species=${taxid}&fields=symbol,genomic_pos,name,exons`;\n}\n\n/** Fetch gene positions from MyGene.info API */\nexport async function fetchLocationsFromMyGeneInfo(genes, taxid) {\n  const annots = [];\n\n  let queryString = getMyGeneInfoQueryString(genes, taxid)\n  const initialData = await fetchMyGeneInfo(queryString);\n\n  let data = initialData\n\n  console.log('data', data)\n\n  data.hits.forEach(gene => {\n    console.log('gene', gene)\n    // If hit lacks position, skip processing\n    if ('genomic_pos' in gene === false) return;\n    if ('name' in gene === false) return;\n\n    const annot = parseAnnotFromMgiGene(gene);\n    annots.push(annot);\n    console.log('gene, length:', gene, annot.stop - annot.start)\n  });\n\n  return annots;\n}\n"],"sourceRoot":""}